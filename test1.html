<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technologies Knowledge Base - Enhanced Editor</title>
    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
        body {
            font-family: Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .auth-section {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
        }

        .auth-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }

        .auth-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .auth-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .controls {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            margin: 2px;
        }

        button:hover {
            background: #0056b3;
        }

        button.delete {
            background: #dc3545;
        }

        button.delete:hover {
            background: #c82333;
        }

        button.success {
            background: #28a745;
        }

        button.success:hover {
            background: #218838;
        }

        button.warning {
            background: #ffc107;
            color: black;
        }

        button.warning:hover {
            background: #e0a800;
        }

        input, textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 5px 0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 5px;
            color: white;
            z-index: 1001;
        }

        .success { background: #28a745; }
        .error { background: #dc3545; }
        .warning { background: #ffc107; color: black; }

        .accordion-container {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
            min-height: 500px;
            overflow: auto;
        }

        .hidden {
            display: none;
        }

        .checklist-section {
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .checklist-item:last-child {
            border-bottom: none;
        }

        .checklist-item input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .checklist-item-text {
            flex-grow: 1;
        }

        .checklist-item.completed .checklist-item-text {
            text-decoration: line-through;
            color: #6c757d;
        }

        .checklist-stats {
            margin-top: 10px;
            padding: 8px;
            background: #e9ecef;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .checklist-actions {
            margin-top: 10px;
        }

        .checklist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .checklist-title {
            font-weight: bold;
            font-size: 1.1em;
        }

        button.auto-save-enabled {
            background: #28a745;
        }

        button.auto-save-enabled:hover {
            background: #218838;
        }

        button.auto-save-disabled {
            background: #6c757d;
        }

        button.auto-save-disabled:hover {
            background: #5a6268;
        }

        .auto-save-status {
            display: inline-block;
            margin-left: 10px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        .auto-save-on {
            background: #d4edda;
            color: #155724;
        }

        .auto-save-off {
            background: #f8d7da;
            color: #721c24;
        }

        .path-display {
            font-size: 0.8em;
            color: #6c757d;
            margin-left: 10px;
            font-style: italic;
        }

        .parent-select-item {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            background: #f8f9fa;
        }

        .parent-select-item:hover {
            background: #e9ecef;
        }

        .parent-select-item.selected {
            background: #007bff;
            color: white;
            border-color: #0056b3;
        }

        /* –ê–∫–∫–æ—Ä–¥–µ–æ–Ω —Å—Ç–∏–ª–∏ */
        .accordion {
            width: 100%;
        }

        .accordion-item {
            margin-bottom: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        .accordion-header {
            padding: 12px 15px;
            background: #f8f9fa;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
            user-select: none;
        }

        .accordion-header:hover {
            background: #e9ecef;
        }

        .accordion-header.category {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
        }

        .accordion-header.technology {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
        }

        .accordion-title {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-grow: 1;
        }

        .accordion-icon {
            font-size: 1.2em;
        }

        .accordion-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: white;
        }

        .accordion-content.expanded {
            max-height: 5000px;
        }

        .accordion-child {
            margin-left: 30px;
            border-left: 2px solid #e9ecef;
        }

        .accordion-stats {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-right: 10px;
        }

        .accordion-progress {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .accordion-actions {
            display: flex;
            gap: 5px;
        }

        .accordion-toggle {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .progress-bar {
            width: 100px;
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin: 5px 0;
        }

        .progress-fill {
            height: 100%;
            background-color: #20c997;
            transition: width 0.3s ease;
        }

        .status-planned { color: #6c757d; }
        .status-in-progress { color: #fd7e14; }
        .status-completed { color: #198754; }

        .checklist-indicator {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 2px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —á–µ–∫-–ª–∏—Å—Ç–∞ */
        .inline-checklist {
            padding: 15px;
            border-top: 1px solid #e9ecef;
            background: #f8f9fa;
        }

        .inline-checklist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .inline-checklist-title {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .inline-checklist-toggle {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
        }

        .inline-checklist-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .inline-checklist-content.expanded {
            max-height: 1000px;
        }

        .inline-checklist-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .inline-checklist-item:last-child {
            border-bottom: none;
        }

        .inline-checklist-item input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .inline-checklist-item-text {
            flex-grow: 1;
            font-size: 0.9em;
        }

        .inline-checklist-item.completed .inline-checklist-item-text {
            text-decoration: line-through;
            color: #6c757d;
        }

        .inline-checklist-stats {
            padding: 8px;
            background: #e9ecef;
            border-radius: 4px;
            font-size: 0.8em;
            margin-top: 10px;
        }

        .inline-checklist-actions {
            margin-top: 10px;
            display: flex;
            gap: 5px;
        }

        .technology-checkbox {
            margin-left: 10px;
        }

        .technology-checkbox input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
        }

        .sync-status {
            margin-top: 10px;
            padding: 8px;
            background: #e9ecef;
            border-radius: 4px;
            font-size: 0.9em;
            color: #6c757d;
        }

        .knowledge-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: #e3f2fd;
            color: #1976d2;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-left: 10px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –∑–Ω–∞–Ω–∏–π */
        .knowledge-content {
            padding: 15px;
            line-height: 1.6;
        }
        
        .knowledge-content h1, 
        .knowledge-content h2, 
        .knowledge-content h3, 
        .knowledge-content h4 {
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            color: #2c3e50;
        }
        
        .knowledge-content h1 { font-size: 1.8em; border-bottom: 2px solid #3498db; padding-bottom: 5px; }
        .knowledge-content h2 { font-size: 1.5em; border-bottom: 1px solid #bdc3c7; padding-bottom: 3px; }
        .knowledge-content h3 { font-size: 1.3em; }
        .knowledge-content h4 { font-size: 1.1em; }
        
        .knowledge-content p {
            margin-bottom: 1em;
        }
        
        .knowledge-content ul, 
        .knowledge-content ol {
            margin-bottom: 1em;
            padding-left: 2em;
        }
        
        .knowledge-content blockquote {
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin: 1em 0;
            color: #7f8c8d;
            font-style: italic;
        }
        
        .knowledge-content code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .knowledge-content pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 1em 0;
        }
        
        .knowledge-content pre code {
            background: none;
            padding: 0;
            color: inherit;
        }
        
        .knowledge-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1em 0;
        }
        
        .knowledge-content table, 
        .knowledge-content th, 
        .knowledge-content td {
            border: 1px solid #bdc3c7;
        }
        
        .knowledge-content th, 
        .knowledge-content td {
            padding: 8px 12px;
            text-align: left;
        }
        
        .knowledge-content th {
            background: #f8f9fa;
        }
        
        .knowledge-content img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
            margin: 10px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .knowledge-content video {
            max-width: 100%;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .internal-link {
            color: #3498db;
            text-decoration: none;
            border-bottom: 1px dashed #3498db;
            cursor: pointer;
        }
        
        .internal-link:hover {
            color: #2980b9;
            border-bottom: 1px solid #2980b9;
        }
        
        .media-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .media-item {
            position: relative;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .media-item img, 
        .media-item video {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .media-item-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
        }
        
        .media-item-actions button {
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            border-radius: 3px;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –∑–Ω–∞–Ω–∏–π */
        .knowledge-modal .modal-content {
            max-width: 900px;
            max-height: 90vh;
        }
        
        .content-tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
        }
        
        .content-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .content-tab.active {
            border-bottom: 2px solid #3498db;
            color: #3498db;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .media-upload-area {
            border: 2px dashed #bdc3c7;
            border-radius: 5px;
            padding: 30px;
            text-align: center;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .media-upload-area:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }
        
        .media-upload-area.dragover {
            border-color: #3498db;
            background: #e3f2fd;
        }
        
        .links-panel {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .link-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .link-item:last-child {
            border-bottom: none;
        }
        
        .search-box {
            margin: 10px 0;
            position: relative;
        }
        
        .search-box input {
            padding-right: 35px;
        }
        
        .search-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
        
        .knowledge-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .content-preview {
            max-height: 200px;
            overflow: hidden;
            position: relative;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #e9ecef;
            border-radius: 5px;
        }
        
        .content-preview:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(transparent, white);
        }

        /* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ */
        .enhanced-editor {
            border: 1px solid #ddd;
            border-radius: 8px;
            margin: 10px 0;
            background: white;
        }
        
        .enhanced-toolbar {
            background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
            padding: 10px;
            border-bottom: 1px solid #ddd;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            border-radius: 8px 8px 0 0;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .toolbar-group {
            display: flex;
            gap: 2px;
            padding: 4px;
            border-radius: 4px;
            background: rgba(255,255,255,0.7);
            border: 1px solid #dee2e6;
        }
        
        .enhanced-toolbar button {
            background: white;
            color: #495057;
            border: 1px solid #ced4da;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            min-width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .enhanced-toolbar button:hover {
            background: #e9ecef;
            border-color: #adb5bd;
            transform: translateY(-1px);
        }
        
        .enhanced-toolbar button.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .enhanced-toolbar select {
            background: white;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 6px;
            font-size: 14px;
            min-width: 100px;
        }
        
        .color-picker {
            display: flex;
            gap: 2px;
        }
        
        .color-option {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            cursor: pointer;
            border: 1px solid #ddd;
        }
        
        .enhanced-editor-content {
            min-height: 400px;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            font-size: 16px;
            outline: none;
            background: white;
            border-radius: 0 0 8px 8px;
        }
        
        .character-count {
            padding: 8px 15px;
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
            font-size: 12px;
            color: #6c757d;
            display: flex;
            justify-content: space-between;
            border-radius: 0 0 8px 8px;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ */
        .editor-h1 { font-size: 2em; font-weight: bold; color: #2c3e50; margin: 0.67em 0; }
        .editor-h2 { font-size: 1.5em; font-weight: bold; color: #34495e; margin: 0.83em 0; }
        .editor-h3 { font-size: 1.25em; font-weight: bold; color: #7f8c8d; margin: 1em 0; }
        .editor-blockquote { 
            border-left: 4px solid #3498db; 
            padding: 10px 20px; 
            margin: 15px 0; 
            background: #f8f9fa;
            font-style: italic;
        }
        
        .editor-code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            position: relative;
        }
        
        .editor-code:before {
            content: '–ö–æ–¥';
            position: absolute;
            top: 5px;
            right: 10px;
            background: #34495e;
            color: #bdc3c7;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.8em;
        }
        
        .editor-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .editor-table th {
            background: #3498db;
            color: white;
            padding: 10px;
            text-align: left;
            border: 1px solid #2980b9;
        }
        
        .editor-table td {
            padding: 8px 10px;
            border: 1px solid #bdc3c7;
            background: white;
        }
        
        .editor-table tr:nth-child(even) td {
            background: #f8f9fa;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ */
        .advanced-modal {
            max-width: 800px;
        }
        
        .modal-tabs {
            display: flex;
            border-bottom: 1px solid #dee2e6;
            margin-bottom: 15px;
        }
        
        .modal-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .modal-tab.active {
            border-bottom: 2px solid #007bff;
            color: #007bff;
            font-weight: bold;
        }
        
        .template-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .template-item {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }
        
        .template-item:hover {
            border-color: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .template-preview {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 10px;
            min-height: 80px;
            font-size: 12px;
        }
        
        .emoji-picker {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 5px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .emoji {
            font-size: 1.5em;
            cursor: pointer;
            text-align: center;
            padding: 5px;
            border-radius: 3px;
            transition: background 0.2s;
        }
        
        .emoji:hover {
            background: #e9ecef;
        }
        
        .fullscreen-editor {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 10000;
            padding: 20px;
        }
        
        .fullscreen-toolbar {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .word-count-badge {
            background: #28a745;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8em;
        }
        
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ */
        .floating-toolbar {
            position: absolute;
            background: #2c3e50;
            border-radius: 6px;
            padding: 8px;
            display: none;
            flex-wrap: wrap;
            gap: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        
        .floating-toolbar button {
            background: #34495e;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .floating-toolbar button:hover {
            background: #3498db;
        }
        
        .syntax-highlighter {
            position: relative;
        }
        
        .syntax-highlighter select {
            background: #2c3e50;
            color: white;
            border: 1px solid #34495e;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 12px;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tooltip {
            position: relative;
        }
        
        .tooltip:before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #2c3e50;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .tooltip:hover:before {
            opacity: 1;
        }
    </style>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <h1>üìö Technologies Knowledge Base - Enhanced Editor</h1>
        
        <!-- –°–µ–∫—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
        <div class="auth-section" id="authSection">
            <h3>üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ GitHub</h3>
            <div>
                <input type="password" id="githubToken" placeholder="GitHub Personal Access Token" style="width: 300px;">
                <input type="text" id="repoOwner" placeholder="–í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è" style="width: 150px;">
                <input type="text" id="repoName" placeholder="–ò–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è" style="width: 150px;">
                <button onclick="authManager.saveAuth()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <button onclick="authManager.testAuth()" class="success">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
            </div>
            <div id="syncStatus" class="sync-status"></div>
            <div id="authStatus" class="auth-status"></div>
            <p><small>–¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ. –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ GitHub —Å –ø—Ä–∞–≤–∞–º–∏ repo</small></p>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã -->
        <div class="controls">
            <div>
                <button onclick="uiManager.showModal('categoryModal')">+ –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                <button onclick="uiManager.showAddNodeModal()">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                <button onclick="uiManager.showAddTechModal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é</button>
                <button onclick="authManager.loadFromGitHub()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å GitHub</button>
                <button onclick="authManager.saveToGitHub()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ GitHub</button>
                <button onclick="authManager.forceSync()">üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</button>
                <button onclick="authManager.toggleAutoSave()" id="autoSaveBtn">üö´ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</button>
                <button onclick="dataManager.exportToJSON()">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON</button>
                <button onclick="dataManager.importFromJSON()">üì§ –ò–º–ø–æ—Ä—Ç –∏–∑ JSON</button>
                <button onclick="knowledgeManager.showGlobalSearch()" class="success">üîç –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π</button>
            </div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ -->
        <div id="accordionContainer" class="accordion-container">
            <div id="accordion" class="accordion"></div>
        </div>

        <!-- –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
        <div id="categoryModal" class="modal">
            <div class="modal-content">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
                <input type="text" id="newCategoryName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏">
                <div>
                    <button onclick="dataManager.addCategory()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <div id="nodeModal" class="modal">
            <div class="modal-content">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
                <div id="nodeParentSelect">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π –≤—ã–±–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—è -->
                </div>
                <input type="text" id="newNodeName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏">
                <div>
                    <button onclick="dataManager.addNode()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <div id="techModal" class="modal">
            <div class="modal-content">
                <h3>–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é</h3>
                <div id="techParentSelect">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π –≤—ã–±–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—è -->
                </div>
                <input type="text" id="newTechName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">
                <div>
                    <button onclick="dataManager.addTechnology()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–º -->
        <div id="checklistModal" class="modal">
            <div class="modal-content">
                <div class="checklist-header">
                    <h3 id="checklistTitle">–ß–µ–∫-–ª–∏—Å—Ç</h3>
                    <button onclick="uiManager.hideModals()">‚úï</button>
                </div>
                
                <div class="checklist-stats" id="checklistStats">
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
                
                <div id="checklistItems">
                    <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —á–µ–∫-–ª–∏—Å—Ç–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                
                <div class="checklist-actions">
                    <input type="text" id="newChecklistItem" placeholder="–ù–æ–≤—ã–π –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç–∞" style="width: calc(100% - 100px);">
                    <button onclick="checklistManager.addChecklistItem()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                
                <div style="margin-top: 15px;">
                    <button onclick="checklistManager.saveChecklist()" class="success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ–∫-–ª–∏—Å—Ç</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <!-- –ù–û–í–´–ï –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê –î–õ–Ø –°–ò–°–¢–ï–ú–´ –ó–ù–ê–ù–ò–ô -->
        <div id="knowledgeModal" class="modal knowledge-modal">
            <div class="modal-content advanced-modal">
                <div class="modal-header">
                    <h3 id="knowledgeTitle">–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</h3>
                    <button onclick="uiManager.hideModals()">‚úï</button>
                </div>
                
                <div class="content-tabs">
                    <div class="content-tab active" onclick="knowledgeManager.switchTab('editor')">
                        <i class="fas fa-edit"></i> –£–ª—É—á—à–µ–Ω–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä
                    </div>
                    <div class="content-tab" onclick="knowledgeManager.switchTab('preview')">
                        <i class="fas fa-eye"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä
                    </div>
                    <div class="content-tab" onclick="knowledgeManager.switchTab('media')">
                        <i class="fas fa-images"></i> –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã
                    </div>
                    <div class="content-tab" onclick="knowledgeManager.switchTab('links')">
                        <i class="fas fa-link"></i> –°—Å—ã–ª–∫–∏
                    </div>
                    <div class="content-tab" onclick="knowledgeManager.switchTab('templates')">
                        <i class="fas fa-layer-group"></i> –®–∞–±–ª–æ–Ω—ã
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
                <div id="editorTab" class="tab-content active">
                    <div class="enhanced-editor">
                        <div class="enhanced-toolbar" id="enhancedToolbar">
                            <!-- –ì—Ä—É–ø–ø–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ -->
                            <div class="toolbar-group">
                                <select id="fontFamily" onchange="enhancedEditor.setFontFamily(this.value)">
                                    <option value="">–®—Ä–∏—Ñ—Ç</option>
                                    <option value="Arial, sans-serif">Arial</option>
                                    <option value="'Times New Roman', serif">Times New Roman</option>
                                    <option value="'Courier New', monospace">Courier New</option>
                                    <option value="Georgia, serif">Georgia</option>
                                    <option value="Verdana, sans-serif">Verdana</option>
                                </select>
                                
                                <select id="fontSize" onchange="enhancedEditor.setFontSize(this.value)">
                                    <option value="">–†–∞–∑–º–µ—Ä</option>
                                    <option value="1">–ú–µ–ª–∫–∏–π</option>
                                    <option value="2">–û–±—ã—á–Ω—ã–π</option>
                                    <option value="3">–°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="4">–ö—Ä—É–ø–Ω—ã–π</option>
                                    <option value="5">–û—á–µ–Ω—å –∫—Ä—É–ø–Ω—ã–π</option>
                                    <option value="6">–û–≥—Ä–æ–º–Ω—ã–π</option>
                                </select>
                            </div>
                            
                            <!-- –ì—Ä—É–ø–ø–∞ —Å—Ç–∏–ª–µ–π —Ç–µ–∫—Å—Ç–∞ -->
                            <div class="toolbar-group">
                                <button onclick="enhancedEditor.toggleStyle('bold')" data-tooltip="–ñ–∏—Ä–Ω—ã–π" class="tooltip">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button onclick="enhancedEditor.toggleStyle('italic')" data-tooltip="–ö—É—Ä—Å–∏–≤" class="tooltip">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button onclick="enhancedEditor.toggleStyle('underline')" data-tooltip="–ü–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ" class="tooltip">
                                    <i class="fas fa-underline"></i>
                                </button>
                                <button onclick="enhancedEditor.toggleStyle('strikethrough')" data-tooltip="–ó–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π" class="tooltip">
                                    <i class="fas fa-strikethrough"></i>
                                </button>
                            </div>
                            
                            <!-- –ì—Ä—É–ø–ø–∞ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è -->
                            <div class="toolbar-group">
                                <button onclick="enhancedEditor.setAlignment('left')" data-tooltip="–í—ã—Ä–æ–≤–Ω—è—Ç—å –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é" class="tooltip">
                                    <i class="fas fa-align-left"></i>
                                </button>
                                <button onclick="enhancedEditor.setAlignment('center')" data-tooltip="–í—ã—Ä–æ–≤–Ω—è—Ç—å –ø–æ —Ü–µ–Ω—Ç—Ä—É" class="tooltip">
                                    <i class="fas fa-align-center"></i>
                                </button>
                                <button onclick="enhancedEditor.setAlignment('right')" data-tooltip="–í—ã—Ä–æ–≤–Ω—è—Ç—å –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é" class="tooltip">
                                    <i class="fas fa-align-right"></i>
                                </button>
                                <button onclick="enhancedEditor.setAlignment('justify')" data-tooltip="–í—ã—Ä–æ–≤–Ω—è—Ç—å –ø–æ —à–∏—Ä–∏–Ω–µ" class="tooltip">
                                    <i class="fas fa-align-justify"></i>
                                </button>
                            </div>
                            
                            <!-- –ì—Ä—É–ø–ø–∞ —Ü–≤–µ—Ç–æ–≤ -->
                            <div class="toolbar-group">
                                <input type="color" id="textColor" onchange="enhancedEditor.setTextColor(this.value)" 
                                       title="–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞" style="width: 40px; height: 36px; padding: 2px;">
                                <input type="color" id="bgColor" onchange="enhancedEditor.setBackgroundColor(this.value)" 
                                       title="–¶–≤–µ—Ç —Ñ–æ–Ω–∞" style="width: 40px; height: 36px; padding: 2px;">
                            </div>
                            
                            <!-- –ì—Ä—É–ø–ø–∞ —Å–ø–∏—Å–∫–æ–≤ -->
                            <div class="toolbar-group">
                                <button onclick="enhancedEditor.insertList('ul')" data-tooltip="–ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫" class="tooltip">
                                    <i class="fas fa-list-ul"></i>
                                </button>
                                <button onclick="enhancedEditor.insertList('ol')" data-tooltip="–ù—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫" class="tooltip">
                                    <i class="fas fa-list-ol"></i>
                                </button>
                                <button onclick="enhancedEditor.outdent()" data-tooltip="–£–º–µ–Ω—å—à–∏—Ç—å –æ—Ç—Å—Ç—É–ø" class="tooltip">
                                    <i class="fas fa-outdent"></i>
                                </button>
                                <button onclick="enhancedEditor.indent()" data-tooltip="–£–≤–µ–ª–∏—á–∏—Ç—å –æ—Ç—Å—Ç—É–ø" class="tooltip">
                                    <i class="fas fa-indent"></i>
                                </button>
                            </div>
                            
                            <!-- –ì—Ä—É–ø–ø–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ -->
                            <div class="toolbar-group">
                                <select onchange="enhancedEditor.setHeading(this.value)">
                                    <option value="p">–û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç</option>
                                    <option value="h1">–ó–∞–≥–æ–ª–æ–≤–æ–∫ 1</option>
                                    <option value="h2">–ó–∞–≥–æ–ª–æ–≤–æ–∫ 2</option>
                                    <option value="h3">–ó–∞–≥–æ–ª–æ–≤–æ–∫ 3</option>
                                    <option value="h4">–ó–∞–≥–æ–ª–æ–≤–æ–∫ 4</option>
                                </select>
                            </div>
                            
                            <!-- –ì—Ä—É–ø–ø–∞ –≤—Å—Ç–∞–≤–∫–∏ -->
                            <div class="toolbar-group">
                                <button onclick="enhancedEditor.showLinkModal()" data-tooltip="–í—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É" class="tooltip">
                                    <i class="fas fa-link"></i>
                                </button>
                                <button onclick="enhancedEditor.showImageModal()" data-tooltip="–í—Å—Ç–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" class="tooltip">
                                    <i class="fas fa-image"></i>
                                </button>
                                <button onclick="enhancedEditor.insertTable()" data-tooltip="–í—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É" class="tooltip">
                                    <i class="fas fa-table"></i>
                                </button>
                                <button onclick="enhancedEditor.insertCode()" data-tooltip="–í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–¥" class="tooltip">
                                    <i class="fas fa-code"></i>
                                </button>
                                <button onclick="enhancedEditor.insertHorizontalRule()" data-tooltip="–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è" class="tooltip">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
                            
                            <!-- –ì—Ä—É–ø–ø–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π -->
                            <div class="toolbar-group">
                                <button onclick="enhancedEditor.showEmojiPicker()" data-tooltip="–í—Å—Ç–∞–≤–∏—Ç—å —ç–º–æ–¥–∑–∏" class="tooltip">
                                    <i class="fas fa-smile"></i>
                                </button>
                                <button onclick="enhancedEditor.insertSpecialChar()" data-tooltip="–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã" class="tooltip">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button onclick="enhancedEditor.clearFormatting()" data-tooltip="–û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ" class="tooltip">
                                    <i class="fas fa-eraser"></i>
                                </button>
                                <button onclick="enhancedEditor.toggleFullscreen()" data-tooltip="–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º" class="tooltip">
                                    <i class="fas fa-expand"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div id="enhancedEditor" class="enhanced-editor-content" contenteditable="true"></div>
                        
                        <div class="character-count">
                            <span id="wordCount">0 —Å–ª–æ–≤</span>
                            <span id="charCount">0 —Å–∏–º–≤–æ–ª–æ–≤</span>
                        </div>
                    </div>
                    
                    <!-- –ü–ª–∞–≤–∞—é—â–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
                    <div id="floatingToolbar" class="floating-toolbar"></div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
                <div id="previewTab" class="tab-content">
                    <div id="knowledgePreview" class="knowledge-content"></div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ -->
                <div id="mediaTab" class="tab-content">
                    <div class="media-upload-area" id="mediaDropZone">
                        üìÅ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –≤–∏–¥–µ–æ<br>
                        <small>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤</small>
                        <input type="file" id="mediaUpload" multiple accept="image/*,video/*" style="display: none;">
                    </div>
                    <div id="mediaGallery" class="media-gallery">
                        <!-- –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ —Å—Å—ã–ª–æ–∫ -->
                <div id="linksTab" class="tab-content">
                    <div class="search-box">
                        <input type="text" id="linkSearch" placeholder="–ü–æ–∏—Å–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π...">
                        <span class="search-icon">üîç</span>
                    </div>
                    <div id="linksList" class="links-panel">
                        <!-- –°–ø–∏—Å–æ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –¥–ª—è —Å—Å—ã–ª–æ–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ -->
                <div id="templatesTab" class="tab-content">
                    <div class="template-gallery">
                        <div class="template-item" onclick="enhancedEditor.insertTemplate('code-example')">
                            <div class="template-preview">
                                // –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞<br>
                                function example() {<br>
                                &nbsp;&nbsp;console.log("Hello");<br>
                                }
                            </div>
                            <div>–®–∞–±–ª–æ–Ω –∫–æ–¥–∞</div>
                        </div>
                        <div class="template-item" onclick="enhancedEditor.insertTemplate('comparison-table')">
                            <div class="template-preview">
                                –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –í–∞—Ä–∏–∞–Ω—Ç A | –í–∞—Ä–∏–∞–Ω—Ç B<br>
                                –°—Ç–æ–∏–º–æ—Å—Ç—å | 100$ | 150$
                            </div>
                            <div>–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞</div>
                        </div>
                        <div class="template-item" onclick="enhancedEditor.insertTemplate('step-by-step')">
                            <div class="template-preview">
                                1. –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞<br>
                                2. –®–∞–≥ 2: –î–µ–π—Å—Ç–≤–∏—è<br>
                                3. –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞
                            </div>
                            <div>–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</div>
                        </div>
                    </div>
                </div>
                
                <div class="knowledge-actions">
                    <div>
                        <button onclick="knowledgeManager.saveContent()" class="success">
                            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                        </button>
                        <button onclick="enhancedEditor.exportAsPDF()">
                            <i class="fas fa-file-pdf"></i> –≠–∫—Å–ø–æ—Ä—Ç PDF
                        </button>
                        <button onclick="enhancedEditor.printContent()">
                            <i class="fas fa-print"></i> –ü–µ—á–∞—Ç—å
                        </button>
                    </div>
                    <button onclick="uiManager.hideModals()">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π -->
        <div id="searchModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üîç –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π</h3>
                    <button onclick="uiManager.hideModals()">‚úï</button>
                </div>
                <div class="search-box">
                    <input type="text" id="globalSearch" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å...">
                    <span class="search-icon">üîç</span>
                </div>
                <div id="searchResults" style="max-height: 400px; overflow-y: auto; margin-top: 15px;">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>

        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
        <div id="linkModal" class="modal">
            <div class="modal-content">
                <h3>–í—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É</h3>
                <input type="text" id="linkUrl" placeholder="URL —Å—Å—ã–ª–∫–∏" style="margin-bottom: 10px;">
                <input type="text" id="linkText" placeholder="–¢–µ–∫—Å—Ç —Å—Å—ã–ª–∫–∏">
                <div style="margin-top: 15px;">
                    <button onclick="enhancedEditor.insertLink()" class="success">–í—Å—Ç–∞–≤–∏—Ç—å</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
        
        <div id="imageModal" class="modal">
            <div class="modal-content">
                <h3>–í—Å—Ç–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h3>
                <input type="text" id="imageUrl" placeholder="URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è" style="margin-bottom: 10px;">
                <input type="text" id="imageAlt" placeholder="–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç">
                <div style="margin-top: 15px;">
                    <button onclick="enhancedEditor.insertImage()" class="success">–í—Å—Ç–∞–≤–∏—Ç—å</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
        
        <div id="emojiModal" class="modal">
            <div class="modal-content">
                <h3>–í—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ–¥–∑–∏</h3>
                <div class="emoji-picker" id="emojiPicker">
                    <!-- –≠–º–æ–¥–∑–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                <div style="margin-top: 15px;">
                    <button onclick="uiManager.hideModals()">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –¥–ª—è JSON -->
        <div id="jsonSection" class="hidden">
            <h3>JSON –¥–∞–Ω–Ω—ã–µ:</h3>
            <textarea id="jsonOutput" style="width: 100%; height: 200px;"></textarea>
            <div>
                <button onclick="dataManager.copyToClipboard()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON</button>
                <button onclick="dataManager.importFromJSONText()">üì§ –ò–º–ø–æ—Ä—Ç –∏–∑ —ç—Ç–æ–≥–æ JSON</button>
                <button onclick="uiManager.hideJSON()">–°–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å—é
        const techData = {
            categories: []
        };

        // –¢–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—É—Ç—å –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        let currentModalPath = [];

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        let lastKnownRemoteSha = null;
        let lastSyncTime = null;

        // –¢–µ–∫—É—â–∏–π —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –∑–Ω–∞–Ω–∏–π
        let currentKnowledgeItem = null;

        // –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
        const accordionManager = {
            init() {
                this.accordionContainer = document.getElementById('accordion');
                this.expandedState = JSON.parse(localStorage.getItem('accordionExpandedState')) || {};
                this.checklistExpandedState = JSON.parse(localStorage.getItem('checklistExpandedState')) || {};
                this.renderAccordion();
            },

            renderAccordion() {
                if (!this.accordionContainer) {
                    console.error('Accordion container not found');
                    return;
                }
                
                this.accordionContainer.innerHTML = '';
                
                if (techData.categories.length === 0) {
                    this.accordionContainer.innerHTML = '<p style="text-align: center; color: #6c757d;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é!</p>';
                    return;
                }

                this.buildAccordion(techData.categories, this.accordionContainer, []);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è
                localStorage.setItem('accordionExpandedState', JSON.stringify(this.expandedState));
                localStorage.setItem('checklistExpandedState', JSON.stringify(this.checklistExpandedState));
            },

            buildAccordion(nodes, parentElement, path) {
                nodes.forEach((node, index) => {
                    const currentPath = [...path, index];
                    const pathKey = currentPath.join('-');
                    
                    // –ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –∑–∞–¥–∞–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–æ—Ä–Ω–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                    if (this.expandedState[pathKey] === undefined) {
                        this.expandedState[pathKey] = path.length === 0;
                    }
                    
                    const item = document.createElement('div');
                    item.className = 'accordion-item';
                    
                    // –†–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è —É–∑–ª–∞
                    const nodeProgress = this.calculateNodeProgress(node);
                    const progress = nodeProgress.progress;
                    const hasChecklistItems = nodeProgress.hasChecklistItems;
                    
                    let statusText = '';
                    let statusClass = '';
                    
                    if (node.type === 'technology') {
                        if (!hasChecklistItems) {
                            statusText = node.completed ? '‚úÖ –ò–∑—É—á–µ–Ω–æ' : 'üìù –í –ø–ª–∞–Ω–∞—Ö';
                            statusClass = node.completed ? 'status-completed' : 'status-planned';
                        } else {
                            if (progress === 0) {
                                statusText = 'üìù –í –ø–ª–∞–Ω–∞—Ö';
                                statusClass = 'status-planned';
                            } else if (progress === 100) {
                                statusText = '‚úÖ –ò–∑—É—á–µ–Ω–æ';
                                statusClass = 'status-completed';
                            } else {
                                statusText = 'üöß –í –ø—Ä–æ—Ü–µ—Å—Å–µ';
                                statusClass = 'status-in-progress';
                            }
                        }
                    } else {
                        // –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—á–µ—Ä–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                        if (progress === 0) {
                            statusText = 'üìù –ù–µ –Ω–∞—á–∞—Ç–æ';
                            statusClass = 'status-planned';
                        } else if (progress === 100) {
                            statusText = '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ';
                            statusClass = 'status-completed';
                        } else {
                            statusText = 'üöß –í –ø—Ä–æ—Ü–µ—Å—Å–µ';
                            statusClass = 'status-in-progress';
                        }
                    }

                    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
                    const header = document.createElement('div');
                    header.className = `accordion-header ${node.type === 'technology' ? 'technology' : 'category'}`;
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è/—Å–∫—Ä—ã—Ç–∏—è
                    header.onclick = (e) => {
                        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                        if (!e.target.closest('.accordion-actions') && !e.target.closest('.accordion-toggle') && 
                            !e.target.closest('.technology-checkbox')) {
                            this.toggleItem(pathKey);
                        }
                    };
                    
                    const title = document.createElement('div');
                    title.className = 'accordion-title';
                    
                    // –ò–∫–æ–Ω–∫–∞ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π/—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
                    const icon = document.createElement('span');
                    icon.className = 'accordion-icon';
                    icon.textContent = node.type === 'technology' ? '‚öôÔ∏è' : 'üìÅ';
                    title.appendChild(icon);
                    
                    // –ù–∞–∑–≤–∞–Ω–∏–µ
                    const name = document.createElement('span');
                    name.textContent = node.name;
                    name.style.fontWeight = 'bold';
                    title.appendChild(name);

                    // –ë–µ–π–¥–∂ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
                    if (node.content && node.content.length > 0) {
                        const badge = document.createElement('span');
                        badge.className = 'knowledge-badge';
                        badge.textContent = 'üìö';
                        badge.title = '–ï—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π';
                        title.appendChild(badge);
                    }
                    
                    header.appendChild(title);
                    
                    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
                    const stats = document.createElement('div');
                    stats.className = 'accordion-stats';
                    
                    const status = document.createElement('span');
                    status.className = statusClass;
                    status.textContent = statusText;
                    stats.appendChild(status);
                    
                    const progressContainer = document.createElement('div');
                    progressContainer.className = 'accordion-progress';
                    
                    const progressBar = document.createElement('div');
                    progressBar.className = 'progress-bar';
                    progressBar.style.width = '100px';
                    const progressFill = document.createElement('div');
                    progressFill.className = 'progress-fill';
                    progressFill.style.width = `${progress}%`;
                    progressBar.appendChild(progressFill);
                    progressContainer.appendChild(progressBar);
                    
                    const progressText = document.createElement('span');
                    progressText.textContent = `${Math.round(progress)}%`;
                    progressText.style.fontSize = '0.9em';
                    progressText.style.color = '#6c757d';
                    progressContainer.appendChild(progressText);
                    
                    stats.appendChild(progressContainer);
                    
                    // –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –±–µ–∑ —á–µ–∫-–ª–∏—Å—Ç–∞
                    if (node.type === 'technology' && (!node.checklist || node.checklist.length === 0)) {
                        const checkboxContainer = document.createElement('div');
                        checkboxContainer.className = 'technology-checkbox';
                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.checked = node.completed || false;
                        checkbox.onchange = (e) => {
                            node.completed = e.target.checked;
                            dataManager.saveToLocalStorage();
                            authManager.scheduleAutoSave();
                            this.renderAccordion();
                        };
                        checkboxContainer.appendChild(checkbox);
                        const label = document.createElement('span');
                        label.textContent = '–ò–∑—É—á–µ–Ω–æ';
                        label.style.fontSize = '0.9em';
                        checkboxContainer.appendChild(label);
                        stats.appendChild(checkboxContainer);
                    }
                    
                    header.appendChild(stats);
                    
                    // –î–µ–π—Å—Ç–≤–∏—è
                    const actions = document.createElement('div');
                    actions.className = 'accordion-actions';
                    
                    if (node.type === 'technology') {
                        actions.innerHTML = `
                            <button onclick="knowledgeManager.openKnowledgeBase('${JSON.stringify(path)}', ${index})" title="–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π" style="background: #9c27b0;">üìö</button>
                            <button onclick="checklistManager.manageChecklist('${JSON.stringify(path)}', ${index})" class="warning" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–º">üìã</button>
                            <button onclick="dataManager.editTechnology('${JSON.stringify(path)}', ${index})" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</button>
                            <button class="delete" onclick="dataManager.deleteTechnology('${JSON.stringify(path)}', ${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                        `;
                    } else {
                        actions.innerHTML = `
                            <button onclick="uiManager.showAddNodeModal('${JSON.stringify(currentPath)}')" title="–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é">+ üìÅ</button>
                            <button onclick="uiManager.showAddTechModal('${JSON.stringify(currentPath)}')" title="–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é">+ ‚öôÔ∏è</button>
                            <button onclick="dataManager.editNode('${JSON.stringify(path)}', ${index})" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</button>
                            <button class="delete" onclick="dataManager.deleteNode('${JSON.stringify(path)}', ${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                        `;
                    }
                    
                    header.appendChild(actions);
                    
                    // –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
                    if (node.children && node.children.length > 0) {
                        const toggle = document.createElement('button');
                        toggle.className = 'accordion-toggle';
                        toggle.innerHTML = this.expandedState[pathKey] ? '‚ñº' : '‚ñ∫';
                        toggle.onclick = (e) => {
                            e.stopPropagation();
                            this.toggleItem(pathKey);
                        };
                        header.appendChild(toggle);
                    }
                    
                    item.appendChild(header);
                    
                    // –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ (–¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã)
                    if (node.children && node.children.length > 0) {
                        const content = document.createElement('div');
                        content.className = 'accordion-content';
                        if (this.expandedState[pathKey]) {
                            content.classList.add('expanded');
                        }
                        
                        const childContainer = document.createElement('div');
                        childContainer.className = 'accordion-child';
                        this.buildAccordion(node.children, childContainer, currentPath);
                        content.appendChild(childContainer);
                        
                        item.appendChild(content);
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π —Å –ø—É–Ω–∫—Ç–∞–º–∏
                    if (node.type === 'technology' && node.checklist && node.checklist.length > 0) {
                        const inlineChecklist = this.createInlineChecklist(node, path, index);
                        item.appendChild(inlineChecklist);
                    }
                    
                    parentElement.appendChild(item);
                });
            },
            
            toggleItem(pathKey) {
                this.expandedState[pathKey] = !this.expandedState[pathKey];
                this.renderAccordion();
            },
            
            createInlineChecklist(tech, path, index) {
                const checklistContainer = document.createElement('div');
                checklistContainer.className = 'inline-checklist';
                
                const checklistKey = path.join('-') + '-' + index;
                const isExpanded = this.checklistExpandedState[checklistKey] !== false; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞—Å–∫—Ä—ã—Ç–æ
                
                const header = document.createElement('div');
                header.className = 'inline-checklist-header';
                
                const title = document.createElement('div');
                title.className = 'inline-checklist-title';
                
                const completedCount = tech.checklist ? tech.checklist.filter(item => item.completed).length : 0;
                const totalCount = tech.checklist ? tech.checklist.length : 0;
                
                title.innerHTML = `
                    <span>üìã –ß–µ–∫-–ª–∏—Å—Ç</span>
                    <span style="font-size: 0.8em; color: #6c757d;">(${completedCount}/${totalCount})</span>
                `;
                
                const toggle = document.createElement('button');
                toggle.className = 'inline-checklist-toggle';
                toggle.innerHTML = isExpanded ? '‚ñº' : '‚ñ∫';
                toggle.onclick = (e) => {
                    e.stopPropagation();
                    this.toggleChecklist(checklistKey);
                };
                
                header.appendChild(title);
                header.appendChild(toggle);
                checklistContainer.appendChild(header);
                
                const content = document.createElement('div');
                content.className = 'inline-checklist-content';
                if (isExpanded) {
                    content.classList.add('expanded');
                }
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                const progress = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
                
                const stats = document.createElement('div');
                stats.className = 'inline-checklist-stats';
                stats.innerHTML = `
                    –ü—Ä–æ–≥—Ä–µ—Å—Å: ${completedCount}/${totalCount} (${progress}%)
                    <div class="progress-bar" style="width: 100%; margin-top: 5px;">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                `;
                content.appendChild(stats);
                
                // –≠–ª–µ–º–µ–Ω—Ç—ã —á–µ–∫-–ª–∏—Å—Ç–∞
                if (tech.checklist && tech.checklist.length > 0) {
                    tech.checklist.forEach((item, itemIndex) => {
                        const itemElement = document.createElement('div');
                        itemElement.className = `inline-checklist-item ${item.completed ? 'completed' : ''}`;
                        itemElement.innerHTML = `
                            <input type="checkbox" ${item.completed ? 'checked' : ''} 
                                   onchange="checklistManager.toggleChecklistItem('${JSON.stringify(path)}', ${index}, ${itemIndex})">
                            <span class="inline-checklist-item-text">${item.text}</span>
                            <button onclick="checklistManager.editChecklistItemInAccordion('${JSON.stringify(path)}', ${index}, ${itemIndex})" style="margin-left: 5px; padding: 2px 6px; font-size: 0.8em;">‚úèÔ∏è</button>
                            <button onclick="checklistManager.removeChecklistItemInAccordion('${JSON.stringify(path)}', ${index}, ${itemIndex})" class="delete" style="margin-left: 2px; padding: 2px 6px; font-size: 0.8em;">üóëÔ∏è</button>
                        `;
                        content.appendChild(itemElement);
                    });
                }
                
                // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                const actions = document.createElement('div');
                actions.className = 'inline-checklist-actions';
                actions.innerHTML = `
                    <button onclick="checklistManager.manageChecklist('${JSON.stringify(path)}', ${index})" class="warning" style="font-size: 0.8em; padding: 4px 8px;">üìã –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
                    <button onclick="checklistManager.addChecklistItemInAccordion('${JSON.stringify(path)}', ${index})" style="font-size: 0.8em; padding: 4px 8px;">+ –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç</button>
                `;
                content.appendChild(actions);
                
                checklistContainer.appendChild(content);
                return checklistContainer;
            },
            
            toggleChecklist(checklistKey) {
                this.checklistExpandedState[checklistKey] = !this.checklistExpandedState[checklistKey];
                this.renderAccordion();
            },
            
            // –†–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è —É–∑–ª–∞ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
            calculateNodeProgress(node) {
                if (node.type === 'technology') {
                    // –î–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                    if (node.checklist && node.checklist.length > 0) {
                        // –ï—Å–ª–∏ –µ—Å—Ç—å —á–µ–∫-–ª–∏—Å—Ç, —Å—á–∏—Ç–∞–µ–º –ø–æ –Ω–µ–º—É
                        const completed = node.checklist.filter(item => item.completed).length;
                        const total = node.checklist.length;
                        const progress = total > 0 ? (completed / total) * 100 : 0;
                        return { progress, hasChecklistItems: true };
                    } else {
                        // –ï—Å–ª–∏ –Ω–µ—Ç —á–µ–∫-–ª–∏—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª–µ completed
                        const progress = node.completed ? 100 : 0;
                        return { progress, hasChecklistItems: false };
                    }
                } else {
                    // –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—Å–µ—Ö –¥–µ—Ç–µ–π
                    if (!node.children || node.children.length === 0) {
                        return { progress: 0, hasChecklistItems: false };
                    }
                    
                    let totalProgress = 0;
                    let childCount = 0;
                    let hasChecklistItems = false;
                    
                    node.children.forEach(child => {
                        const childProgress = this.calculateNodeProgress(child);
                        totalProgress += childProgress.progress;
                        childCount++;
                        if (childProgress.hasChecklistItems) {
                            hasChecklistItems = true;
                        }
                    });
                    
                    const progress = childCount > 0 ? totalProgress / childCount : 0;
                    return { progress, hasChecklistItems };
                }
            }
        };

        // Data Manager
        const dataManager = {
            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—É—Ç—è–º–∏
            getNodeByPath(path) {
                let currentNode = techData.categories;
                for (const index of path) {
                    if (currentNode[index]) {
                        currentNode = currentNode[index].children || [];
                    } else {
                        return null;
                    }
                }
                return currentNode;
            },

            getNodeAtIndex(path, index) {
                const parent = this.getNodeByPath(path);
                return parent ? parent[index] : null;
            },

            // === –õ–û–ö–ê–õ–¨–ù–û–ï –•–†–ê–ù–ò–õ–ò–©–ï ===
            saveToLocalStorage() {
                localStorage.setItem('techData', JSON.stringify(techData));
            },

            loadFromLocalStorage() {
                const saved = localStorage.getItem('techData');
                if (saved) {
                    try {
                        const parsedData = JSON.parse(saved);
                        techData.categories = parsedData.categories || [];
                        this.renderCurrentView();
                    } catch (e) {
                        console.error('Error parsing saved data:', e);
                    }
                }
            },

            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –≤–∏–¥–∞
            renderCurrentView() {
                accordionManager.renderAccordion();
            },

            // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–ú–ò ===
            addCategory() {
                const name = document.getElementById('newCategoryName').value.trim();
                if (name) {
                    techData.categories.push({
                        name: name,
                        type: 'category',
                        children: []
                    });
                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.hideModals();
                    document.getElementById('newCategoryName').value = '';
                    uiManager.showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                    
                    authManager.scheduleAutoSave();
                } else {
                    uiManager.showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏!', 'error');
                }
            },

            addNode() {
                const name = document.getElementById('newNodeName').value.trim();
                
                if (name && currentModalPath.length >= 0) {
                    const parent = this.getNodeByPath(currentModalPath);
                    if (!parent) {
                        uiManager.showNotification('–û—à–∏–±–∫–∞: —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                        return;
                    }

                    parent.push({
                        name: name,
                        type: 'node',
                        children: []
                    });

                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.hideModals();
                    document.getElementById('newNodeName').value = '';
                    uiManager.showNotification('–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                    
                    authManager.scheduleAutoSave();
                } else {
                    uiManager.showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏!', 'error');
                }
            },

            addTechnology() {
                const name = document.getElementById('newTechName').value.trim();
                
                if (name && currentModalPath.length >= 0) {
                    const parent = this.getNodeByPath(currentModalPath);
                    if (!parent) {
                        uiManager.showNotification('–û—à–∏–±–∫–∞: —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                        return;
                    }

                    const tech = {
                        name: name,
                        type: 'technology',
                        checklist: [],
                        completed: false
                    };

                    parent.push(tech);

                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.hideModals();
                    document.getElementById('newTechName').value = '';
                    uiManager.showNotification('–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                    
                    authManager.scheduleAutoSave();
                } else {
                    uiManager.showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏!', 'error');
                }
            },

            // –§—É–Ω–∫—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            editNode(pathStr, index) {
                const path = JSON.parse(pathStr);
                const node = this.getNodeAtIndex(path, index);
                if (!node) return;

                const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:', node.name);
                if (newName && newName.trim()) {
                    node.name = newName.trim();
                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
                    authManager.scheduleAutoSave();
                }
            },

            editTechnology(pathStr, index) {
                const path = JSON.parse(pathStr);
                const node = this.getNodeAtIndex(path, index);
                if (!node) return;

                const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:', node.name);
                if (newName && newName.trim()) {
                    node.name = newName.trim();
                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.showNotification('–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
                    authManager.scheduleAutoSave();
                }
            },

            // –§—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è
            deleteNode(pathStr, index) {
                const path = JSON.parse(pathStr);
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –≤—Å–µ –µ—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ?')) {
                    const parent = this.getNodeByPath(path);
                    if (parent) {
                        parent.splice(index, 1);
                        this.renderCurrentView();
                        this.saveToLocalStorage();
                        uiManager.showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞!', 'success');
                        authManager.scheduleAutoSave();
                    }
                }
            },

            deleteTechnology(pathStr, index) {
                const path = JSON.parse(pathStr);
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é –∏ –≤—Å–µ –µ—ë –∑–∞–¥–∞—á–∏?')) {
                    const parent = this.getNodeByPath(path);
                    if (parent) {
                        parent.splice(index, 1);
                        this.renderCurrentView();
                        this.saveToLocalStorage();
                        uiManager.showNotification('–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —É–¥–∞–ª–µ–Ω–∞!', 'success');
                        authManager.scheduleAutoSave();
                    }
                }
            },

            // === –†–ê–ë–û–¢–ê –° JSON ===
            exportToJSON() {
                const jsonOutput = document.getElementById('jsonOutput');
                const jsonSection = document.getElementById('jsonSection');
                
                jsonOutput.value = JSON.stringify(techData, null, 2);
                jsonSection.classList.remove('hidden');
            },

            importFromJSON() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const parsedData = JSON.parse(e.target.result);
                            techData.categories = parsedData.categories || [];
                            dataManager.renderCurrentView();
                            dataManager.saveToLocalStorage();
                            uiManager.showNotification('–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
                            authManager.scheduleAutoSave();
                        } catch (error) {
                            uiManager.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ JSON —Ñ–∞–π–ª–∞', 'error');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            },

            importFromJSONText() {
                const jsonText = document.getElementById('jsonOutput').value;
                try {
                    const parsedData = JSON.parse(jsonText);
                    techData.categories = parsedData.categories || [];
                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.showNotification('–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ JSON!', 'success');
                    authManager.scheduleAutoSave();
                } catch (error) {
                    uiManager.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–∑–±–æ—Ä–µ JSON', 'error');
                }
            },

            copyToClipboard() {
                const jsonOutput = document.getElementById('jsonOutput');
                jsonOutput.select();
                document.execCommand('copy');
                uiManager.showNotification('JSON —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            }
        };

        // UI Manager
        const uiManager = {
            showModal(modalId) {
                document.getElementById(modalId).style.display = 'block';
            },

            showAddNodeModal(pathStr = '[]') {
                const path = JSON.parse(pathStr);
                currentModalPath = path;
                this.updateParentSelect('nodeModal', path);
                this.showModal('nodeModal');
            },

            showAddTechModal(pathStr = '[]') {
                const path = JSON.parse(pathStr);
                currentModalPath = path;
                this.updateParentSelect('techModal', path);
                this.showModal('techModal');
            },

            hideModals() {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            },

            hideJSON() {
                document.getElementById('jsonSection').classList.add('hidden');
            },

            updateParentSelect(modalId, currentPath) {
                const container = document.getElementById(modalId === 'nodeModal' ? 'nodeParentSelect' : 'techParentSelect');
                if (!container) return;
                
                container.innerHTML = '';
                
                const title = document.createElement('div');
                title.innerHTML = `<strong>–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${this.getPathDisplay(currentPath) || '–ö–æ—Ä–µ–Ω—å'}`;
                container.appendChild(title);
            },

            getPathDisplay(path) {
                if (path.length === 0) return '';
                let currentNode = techData.categories;
                let pathNames = [];
                
                for (const index of path) {
                    if (currentNode[index]) {
                        pathNames.push(currentNode[index].name);
                        currentNode = currentNode[index].children || [];
                    }
                }
                
                return pathNames.join(' ‚Üí ');
            },

            showNotification(message, type) {
                const oldNotifications = document.querySelectorAll('.notification');
                oldNotifications.forEach(notif => notif.remove());
                
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }
        };

        // Checklist Manager
        const checklistManager = {
            currentChecklist: {
                path: [],
                techIndex: -1
            },

            // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –ß–ï–ö-–õ–ò–°–¢–ê–ú–ò ===
            manageChecklist(pathStr, techIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = {
                    path,
                    techIndex
                };
                
                const tech = this.getTechnology();
                if (!tech) return;
                
                document.getElementById('checklistTitle').textContent = `–ß–µ–∫-–ª–∏—Å—Ç: ${tech.name}`;
                
                if (!tech.checklist) {
                    tech.checklist = [];
                }
                
                this.renderChecklist();
                uiManager.showModal('checklistModal');
            },
            
            renderChecklist() {
                const tech = this.getTechnology();
                if (!tech) return;
                
                const checklistItems = document.getElementById('checklistItems');
                const checklistStats = document.getElementById('checklistStats');
                
                if (!checklistItems || !checklistStats) return;
                
                checklistItems.innerHTML = '';
                
                if (tech.checklist && tech.checklist.length > 0) {
                    tech.checklist.forEach((item, index) => {
                        const itemElement = document.createElement('div');
                        itemElement.className = `checklist-item ${item.completed ? 'completed' : ''}`;
                        itemElement.innerHTML = `
                            <input type="checkbox" ${item.completed ? 'checked' : ''} 
                                   onchange="checklistManager.toggleChecklistItem('${JSON.stringify(this.currentChecklist.path)}', ${this.currentChecklist.techIndex}, ${index})">
                            <span class="checklist-item-text">${item.text}</span>
                            <button onclick="checklistManager.removeChecklistItem(${index})" class="delete" style="margin-left: 10px;">üóëÔ∏è</button>
                            <button onclick="checklistManager.editChecklistItem(${index})" style="margin-left: 5px;">‚úèÔ∏è</button>
                        `;
                        checklistItems.appendChild(itemElement);
                    });
                } else {
                    checklistItems.innerHTML = '<p style="text-align: center; color: #6c757d;">–ß–µ–∫-–ª–∏—Å—Ç –ø—É—Å—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π –ø—É–Ω–∫—Ç!</p>';
                }
                
                const completed = tech.checklist ? tech.checklist.filter(item => item.completed).length : 0;
                const total = tech.checklist ? tech.checklist.length : 0;
                const progress = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                checklistStats.innerHTML = `
                    –ü—Ä–æ–≥—Ä–µ—Å—Å: ${completed}/${total} (${progress}%)
                    <div class="progress-bar" style="width: 100%; margin-top: 5px;">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                `;
            },
            
            addChecklistItem() {
                const input = document.getElementById('newChecklistItem');
                if (!input) return;
                
                const text = input.value.trim();
                
                if (text) {
                    const tech = this.getTechnology();
                    if (!tech) return;
                    
                    if (!tech.checklist) {
                        tech.checklist = [];
                    }
                    
                    tech.checklist.push({
                        text: text,
                        completed: false
                    });
                    
                    input.value = '';
                    this.renderChecklist();
                    dataManager.saveToLocalStorage();
                    authManager.scheduleAutoSave();
                    dataManager.renderCurrentView();
                }
            },

            addChecklistItemInAccordion(pathStr, techIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = { path, techIndex };
                const text = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç–∞:');
                if (text && text.trim()) {
                    const tech = this.getTechnology();
                    if (!tech) return;
                    
                    if (!tech.checklist) {
                        tech.checklist = [];
                    }
                    
                    tech.checklist.push({
                        text: text.trim(),
                        completed: false
                    });
                    
                    dataManager.saveToLocalStorage();
                    authManager.scheduleAutoSave();
                    dataManager.renderCurrentView();
                }
            },
            
            removeChecklistItem(index) {
                const tech = this.getTechnology();
                if (!tech) return;
                
                if (tech.checklist && tech.checklist.length > index) {
                    tech.checklist.splice(index, 1);
                    this.renderChecklist();
                    dataManager.saveToLocalStorage();
                    authManager.scheduleAutoSave();
                    dataManager.renderCurrentView();
                }
            },

            removeChecklistItemInAccordion(pathStr, techIndex, itemIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = { path, techIndex };
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç–∞?')) {
                    const tech = this.getTechnology();
                    if (!tech) return;
                    
                    if (tech.checklist && tech.checklist.length > itemIndex) {
                        tech.checklist.splice(itemIndex, 1);
                        dataManager.saveToLocalStorage();
                        authManager.scheduleAutoSave();
                        dataManager.renderCurrentView();
                    }
                }
            },
            
            editChecklistItem(index) {
                const tech = this.getTechnology();
                if (!tech) return;
                
                if (tech.checklist && tech.checklist.length > index) {
                    const newText = prompt('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É–Ω–∫—Ç:', tech.checklist[index].text);
                    if (newText !== null) {
                        tech.checklist[index].text = newText.trim();
                        this.renderChecklist();
                        dataManager.saveToLocalStorage();
                        authManager.scheduleAutoSave();
                        dataManager.renderCurrentView();
                    }
                }
            },

            editChecklistItemInAccordion(pathStr, techIndex, itemIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = { path, techIndex };
                const tech = this.getTechnology();
                if (!tech) return;
                
                if (tech.checklist && tech.checklist.length > itemIndex) {
                    const newText = prompt('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É–Ω–∫—Ç:', tech.checklist[itemIndex].text);
                    if (newText !== null) {
                        tech.checklist[itemIndex].text = newText.trim();
                        dataManager.saveToLocalStorage();
                        authManager.scheduleAutoSave();
                        dataManager.renderCurrentView();
                    }
                }
            },
            
            toggleChecklistItem(pathStr, techIndex, itemIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = { path, techIndex };
                const tech = this.getTechnology();
                if (!tech) return;
                
                if (tech.checklist && tech.checklist.length > itemIndex) {
                    tech.checklist[itemIndex].completed = !tech.checklist[itemIndex].completed;
                    dataManager.saveToLocalStorage();
                    authManager.scheduleAutoSave();
                    dataManager.renderCurrentView();
                }
            },
            
            saveChecklist() {
                uiManager.hideModals();
                dataManager.saveToLocalStorage();
                uiManager.showNotification('–ß–µ–∫-–ª–∏—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
                authManager.scheduleAutoSave();
                dataManager.renderCurrentView();
            },
            
            getTechnology() {
                const parent = dataManager.getNodeByPath(this.currentChecklist.path);
                return parent ? parent[this.currentChecklist.techIndex] : null;
            }
        };

        // Auth Manager
        const authManager = {
            autoSaveEnabled: false,
            autoSaveInterval: null,
            lastSaveTime: null,
            autoSaveTimeout: null,

            // === –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø –° –ü–†–û–í–ï–†–ö–û–ô ===
            async testAuth() {
                const token = document.getElementById('githubToken').value;
                const owner = document.getElementById('repoOwner').value;
                const repo = document.getElementById('repoName').value;
                
                if (!token || !owner || !repo) {
                    this.showAuthStatus('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
                    return;
                }

                try {
                    this.showAuthStatus('–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...', 'warning');
                    
                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}`, {
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'TechDocs-App'
                        }
                    });

                    const responseData = await response.json();

                    if (response.status === 200) {
                        const permissions = responseData.permissions;
                        if (permissions && permissions.push) {
                            this.showAuthStatus('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ! –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏.', 'success');
                            this.enableAutoSave();
                        } else {
                            this.showAuthStatus('‚ö†Ô∏è –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å.', 'warning');
                        }
                    } else if (response.status === 404) {
                        this.showAuthStatus('‚ùå –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è –∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞.', 'error');
                    } else if (response.status === 401) {
                        this.showAuthStatus('‚ùå –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω.', 'error');
                    } else if (response.status === 403) {
                        this.showAuthStatus('üö´ –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ repo.', 'error');
                    } else {
                        this.showAuthStatus(`‚ùå –û—à–∏–±–∫–∞: ${response.status} - ${responseData.message || response.statusText}`, 'error');
                    }
                } catch (error) {
                    console.error('Auth test error:', error);
                    this.showAuthStatus('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
                }
            },

            saveAuth() {
                const token = document.getElementById('githubToken').value;
                const owner = document.getElementById('repoOwner').value;
                const repo = document.getElementById('repoName').value;
                
                if (token && owner && repo) {
                    localStorage.setItem('githubToken', token);
                    localStorage.setItem('repoOwner', owner);
                    localStorage.setItem('repoName', repo);
                    uiManager.showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
                    setTimeout(() => this.testAuth(), 500);
                } else {
                    uiManager.showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
                }
            },

            loadAuth() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (token) document.getElementById('githubToken').value = token;
                if (owner) document.getElementById('repoOwner').value = owner;
                if (repo) document.getElementById('repoName').value = repo;
                
                if (token && owner && repo) {
                    setTimeout(() => this.testAuth(), 1000);
                }
            },

            showAuthStatus(message, type) {
                const authStatus = document.getElementById('authStatus');
                if (!authStatus) return;
                
                authStatus.textContent = message;
                authStatus.className = 'auth-status';
                authStatus.classList.add(type === 'success' ? 'auth-success' : 
                                       type === 'warning' ? 'auth-warning' : 'auth-error');
                authStatus.style.display = 'block';
            },

            // === –ê–í–¢–û–°–û–•–†–ê–ù–ï–ù–ò–ï –° –ü–†–ï–î–û–¢–í–†–ê–©–ï–ù–ò–ï–ú –ü–ï–†–ï–ó–ê–ü–ò–°–ò ===
            enableAutoSave() {
                if (this.autoSaveEnabled) return;
                
                this.autoSaveEnabled = true;
                this.updateAutoSaveButton();
                
                this.autoSaveInterval = setInterval(() => {
                    this.autoSaveToGitHub();
                }, 2 * 60 * 1000);
                
                window.addEventListener('beforeunload', this.autoSaveToGitHub.bind(this));
                
                uiManager.showNotification('üîÑ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ (–∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã)', 'success');
            },
            
            disableAutoSave() {
                if (this.autoSaveInterval) {
                    clearInterval(this.autoSaveInterval);
                    this.autoSaveInterval = null;
                }
                this.autoSaveEnabled = false;
                this.updateAutoSaveButton();
                window.removeEventListener('beforeunload', this.autoSaveToGitHub.bind(this));
                uiManager.showNotification('‚è∏Ô∏è –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ', 'warning');
            },
            
            toggleAutoSave() {
                if (this.autoSaveEnabled) {
                    this.disableAutoSave();
                } else {
                    this.enableAutoSave();
                }
            },
            
            updateAutoSaveButton() {
                const button = document.getElementById('autoSaveBtn');
                if (!button) return;
                
                if (this.autoSaveEnabled) {
                    button.innerHTML = '‚úÖ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ';
                    button.className = 'auto-save-enabled';
                } else {
                    button.innerHTML = 'üö´ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ';
                    button.className = 'auto-save-disabled';
                }
            },
            
            async autoSaveToGitHub() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (!token || !owner || !repo || !this.autoSaveEnabled) {
                    return;
                }

                const now = Date.now();
                if (this.lastSaveTime && (now - this.lastSaveTime) < 30000) {
                    return;
                }

                try {
                    console.log('üîÑ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ GitHub...');
                    
                    let currentRemoteSha = null;
                    let remoteData = null;
                    
                    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞ GitHub
                    try {
                        const getResponse = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                            headers: {
                                'Authorization': `token ${token}`,
                                'Accept': 'application/vnd.github.v3+json',
                                'User-Agent': 'TechDocs-App'
                            }
                        });
                        
                        if (getResponse.status === 200) {
                            const data = await getResponse.json();
                            currentRemoteSha = data.sha;
                            
                            // –ï—Å–ª–∏ —Ñ–∞–π–ª –∏–∑–º–µ–Ω–∏–ª—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                            if (lastKnownRemoteSha && currentRemoteSha !== lastKnownRemoteSha) {
                                console.log('‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–ª—è —Å–ª–∏—è–Ω–∏—è...');
                                const remoteContent = decodeURIComponent(escape(atob(data.content)));
                                remoteData = JSON.parse(remoteContent);
                                
                                // –°–ª–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                                this.mergeData(remoteData);
                            }
                            
                            lastKnownRemoteSha = currentRemoteSha;
                        } else if (getResponse.status === 404) {
                            // –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                            console.log('üìù –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π');
                        }
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ–∞–π–ª–∞ –¥–ª—è –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
                        return;
                    }

                    const content = JSON.stringify(techData, null, 2);
                    const contentBase64 = btoa(unescape(encodeURIComponent(content)));
                    const message = `Auto-save: ${new Date().toLocaleString()}`;
                    
                    const requestBody = {
                        message: message,
                        content: contentBase64
                    };

                    if (currentRemoteSha) {
                        requestBody.sha = currentRemoteSha;
                    }

                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json',
                            'User-Agent': 'TechDocs-App'
                        },
                        body: JSON.stringify(requestBody)
                    });

                    if (response.status === 200 || response.status === 201) {
                        this.lastSaveTime = Date.now();
                        lastSyncTime = Date.now();
                        this.updateSyncStatus();
                        console.log('‚úÖ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ');
                        
                        if (!document.hidden) {
                            this.showAutoSaveNotification();
                        }
                    } else {
                        console.warn('‚ö†Ô∏è –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å:', response.status);
                        
                        // –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–∞–∑—Ä–µ—à–∏—Ç—å –µ–≥–æ
                        if (response.status === 409) {
                            this.handleSyncConflict();
                        }
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                }
            },
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–ª–∏—è–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
            mergeData(remoteData) {
                if (!remoteData || !remoteData.categories) return;
                
                console.log('üîÑ –ù–∞—á–∏–Ω–∞–µ–º —Å–ª–∏—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...');
                
                // –ü—Ä–æ—Å—Ç–æ–µ —Å–ª–∏—è–Ω–∏–µ: –¥–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞
                remoteData.categories.forEach(remoteCategory => {
                    const localCategory = techData.categories.find(cat => cat.name === remoteCategory.name);
                    
                    if (!localCategory) {
                        // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –¥–æ–±–∞–≤–ª—è–µ–º –µ—ë
                        techData.categories.push(JSON.parse(JSON.stringify(remoteCategory)));
                        console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è: ${remoteCategory.name}`);
                    } else {
                        // –°–ª–∏–≤–∞–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                        this.mergeTechnologies(localCategory, remoteCategory);
                    }
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                dataManager.saveToLocalStorage();
                dataManager.renderCurrentView();
                
                uiManager.showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'success');
            },

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–ª–∏—è–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
            mergeTechnologies(localCategory, remoteCategory) {
                if (!remoteCategory.children) return;
                
                remoteCategory.children.forEach(remoteItem => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è/–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è
                    const exists = localCategory.children.some(localItem => 
                        localItem.name === remoteItem.name && localItem.type === remoteItem.type
                    );
                    
                    if (!exists) {
                        // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
                        localCategory.children.push(JSON.parse(JSON.stringify(remoteItem)));
                        console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω ${remoteItem.type === 'technology' ? '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è' : '–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è'}: ${remoteItem.name}`);
                    } else if (remoteItem.type === 'technology') {
                        // –î–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ —Å–ª–∏–≤–∞—Ç—å —á–µ–∫-–ª–∏—Å—Ç—ã
                        this.mergeChecklists(localCategory, remoteItem);
                    }
                });
            },

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–ª–∏—è–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–≤
            mergeChecklists(localCategory, remoteTech) {
                const localTech = localCategory.children.find(item => 
                    item.name === remoteTech.name && item.type === 'technology'
                );
                
                if (!localTech || !remoteTech.checklist) return;
                
                if (!localTech.checklist) {
                    localTech.checklist = [];
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—É–Ω–∫—Ç—ã —á–µ–∫-–ª–∏—Å—Ç–∞
                remoteTech.checklist.forEach(remoteItem => {
                    const exists = localTech.checklist.some(localItem => 
                        localItem.text === remoteItem.text
                    );
                    
                    if (!exists) {
                        localTech.checklist.push(JSON.parse(JSON.stringify(remoteItem)));
                        console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç–∞: ${remoteItem.text}`);
                    }
                });
            },

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            handleSyncConflict() {
                if (confirm('–û–±–Ω–∞—Ä—É–∂–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π. –•–æ—Ç–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å –≤–∞—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏?')) {
                    this.loadFromGitHubWithMerge();
                } else {
                    uiManager.showNotification('‚ö†Ô∏è –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ –∏–∑-–∑–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞', 'warning');
                    this.disableAutoSave();
                }
            },

            // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å GitHub –¥–ª—è —Å–ª–∏—è–Ω–∏—è
            async loadFromGitHubWithMerge() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (!token || !owner || !repo) {
                    uiManager.showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ GitHub!', 'error');
                    return;
                }

                try {
                    uiManager.showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–ª–∏—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å GitHub...', 'warning');
                    
                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'TechDocs-App'
                        }
                    });

                    if (response.status === 200) {
                        const data = await response.json();
                        const content = decodeURIComponent(escape(atob(data.content)));
                        const remoteData = JSON.parse(content);
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ —Å–ª–∏—è–Ω–∏–µ–º
                        const localDataBackup = JSON.parse(JSON.stringify(techData));
                        
                        // –°–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                        this.mergeData(remoteData);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º SHA
                        lastKnownRemoteSha = data.sha;
                        lastSyncTime = Date.now();
                        this.updateSyncStatus();
                        
                        uiManager.showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã!', 'success');
                        
                        // –í–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ
                        this.enableAutoSave();
                    } else {
                        throw new Error(`GitHub API error: ${response.status}`);
                    }
                } catch (error) {
                    console.error('GitHub load error:', error);
                    uiManager.showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message, 'error');
                }
            },

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            async forceSync() {
                if (confirm('–≠—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é —Å GitHub –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç —Å –≤–∞—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                    await this.loadFromGitHubWithMerge();
                }
            },

            showAutoSaveNotification() {
                const notification = document.createElement('div');
                notification.innerHTML = 'üíæ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ';
                notification.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    right: 20px;
                    background: #28a745;
                    color: white;
                    padding: 8px 12px;
                    border-radius: 4px;
                    font-size: 12px;
                    z-index: 1002;
                    opacity: 0.9;
                `;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 2000);
            },
            
            scheduleAutoSave() {
                if (!this.autoSaveEnabled) return;
                
                if (this.autoSaveTimeout) {
                    clearTimeout(this.autoSaveTimeout);
                }
                
                this.autoSaveTimeout = setTimeout(() => {
                    this.autoSaveToGitHub();
                }, 10000);
            },

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            updateSyncStatus() {
                const syncStatus = document.getElementById('syncStatus');
                if (!syncStatus) return;
                
                if (lastSyncTime) {
                    const lastSync = new Date(lastSyncTime).toLocaleString();
                    syncStatus.innerHTML = `üîÑ –ü–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: ${lastSync}`;
                } else {
                    syncStatus.innerHTML = '‚è≥ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å';
                }
            },

            // === –†–ê–ë–û–¢–ê –° GITHUB API ===
            async loadFromGitHub() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (!token || !owner || !repo) {
                    uiManager.showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ GitHub!', 'error');
                    return;
                }

                try {
                    uiManager.showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å GitHub...', 'warning');
                    
                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'TechDocs-App'
                        }
                    });

                    if (response.status === 200) {
                        const data = await response.json();
                        const content = decodeURIComponent(escape(atob(data.content)));
                        const parsedData = JSON.parse(content);
                        
                        techData.categories = parsedData.categories || [];
                        dataManager.renderCurrentView();
                        dataManager.saveToLocalStorage();
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                        lastKnownRemoteSha = data.sha;
                        lastSyncTime = Date.now();
                        this.updateSyncStatus();
                        
                        uiManager.showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å GitHub!', 'success');
                    } else if (response.status === 404) {
                        uiManager.showNotification('üìù –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª.', 'warning');
                        techData.categories = [];
                        dataManager.renderCurrentView();
                        dataManager.saveToLocalStorage();
                    } else {
                        const errorData = await response.json();
                        throw new Error(`GitHub API error: ${response.status} - ${errorData.message || response.statusText}`);
                    }
                } catch (error) {
                    console.error('GitHub load error:', error);
                    uiManager.showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message, 'error');
                }
            },

            async saveToGitHub() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (!token || !owner || !repo) {
                    uiManager.showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ GitHub!', 'error');
                    return;
                }

                try {
                    uiManager.showNotification('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ GitHub...', 'warning');
                    
                    if (!techData || techData.categories.length === 0) {
                        uiManager.showNotification('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!', 'error');
                        return;
                    }

                    let sha = null;
                    
                    try {
                        const getResponse = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                            headers: {
                                'Authorization': `token ${token}`,
                                'Accept': 'application/vnd.github.v3+json',
                                'User-Agent': 'TechDocs-App'
                            }
                        });
                        
                        if (getResponse.status === 200) {
                            const data = await getResponse.json();
                            sha = data.sha;
                        }
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ–∞–π–ª–∞:', e);
                    }

                    const content = JSON.stringify(techData, null, 2);
                    const contentBase64 = btoa(unescape(encodeURIComponent(content)));
                    const message = `Update tech data: ${new Date().toLocaleString()}`;
                    
                    const requestBody = {
                        message: message,
                        content: contentBase64
                    };

                    if (sha) {
                        requestBody.sha = sha;
                    }

                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json',
                            'User-Agent': 'TechDocs-App'
                        },
                        body: JSON.stringify(requestBody)
                    });

                    const responseData = await response.json();

                    if (response.status === 200 || response.status === 201) {
                        lastSyncTime = Date.now();
                        this.updateSyncStatus();
                        uiManager.showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ GitHub!', 'success');
                    } else {
                        let errorMessage = `–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${response.status}`;
                        if (responseData && responseData.message) {
                            errorMessage += ` - ${responseData.message}`;
                            
                            if (responseData.message.includes('bad credentials')) {
                                errorMessage += '\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞';
                            } else if (responseData.message.includes('not found')) {
                                errorMessage += '\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞';
                            } else if (responseData.message.includes('sha')) {
                                errorMessage += '\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞, –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å';
                            }
                        }
                        throw new Error(errorMessage);
                    }
                } catch (error) {
                    console.error('GitHub save error:', error);
                    uiManager.showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + error.message, 'error');
                }
            }
        };

        // Knowledge Manager
        const knowledgeManager = {
            currentItem: null,
            
            // –û—Ç–∫—Ä—ã—Ç–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞
            openKnowledgeBase(pathStr, index) {
                const path = JSON.parse(pathStr);
                const item = dataManager.getNodeAtIndex(path, index);
                
                if (!item) {
                    uiManager.showNotification('–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    return;
                }
                
                this.currentItem = item;
                currentKnowledgeItem = item;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–ª–µ content, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                if (!item.content) {
                    item.content = '';
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                if (!item.media) {
                    item.media = [];
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Å—ã–ª–∫–∏, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                if (!item.links) {
                    item.links = [];
                }
                
                document.getElementById('knowledgeTitle').textContent = `–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π: ${item.name}`;
                document.getElementById('enhancedEditor').innerHTML = item.content || '';
                enhancedEditor.updateCharacterCount();
                this.renderPreview();
                this.renderMedia();
                this.renderLinks();
                
                uiManager.showModal('knowledgeModal');
            },
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
            switchTab(tabName) {
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
                document.querySelectorAll('.content-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
                document.getElementById(`${tabName}Tab`).classList.add('active');
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.content-tab').forEach(tab => {
                    if (tab.textContent.includes(this.getTabIcon(tabName))) {
                        tab.classList.add('active');
                    }
                });
                
                // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∏—Å—å –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä, –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–≤—å—é
                if (tabName === 'preview') {
                    this.renderPreview();
                }
            },
            
            getTabIcon(tabName) {
                const icons = {
                    'editor': '‚úèÔ∏è',
                    'preview': 'üëÅÔ∏è',
                    'media': 'üñºÔ∏è',
                    'links': 'üîó',
                    'templates': 'üìã'
                };
                return icons[tabName] || '';
            },
            
            // –†–µ–Ω–¥–µ—Ä –ø—Ä–µ–≤—å—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            renderPreview() {
                const content = document.getElementById('enhancedEditor').innerHTML;
                document.getElementById('knowledgePreview').innerHTML = content;
                
                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏
                this.processInternalLinks();
            },
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫ –≤ –ø—Ä–µ–≤—å—é
            processInternalLinks() {
                const internalLinks = document.querySelectorAll('.internal-link');
                internalLinks.forEach(link => {
                    link.onclick = (e) => {
                        e.preventDefault();
                        const targetId = link.getAttribute('data-target');
                        this.navigateToInternalLink(targetId);
                    };
                });
            },
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å—Å—ã–ª–∫–∞–º
            navigateToInternalLink(targetId) {
                // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ ID –∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –µ–≥–æ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
                uiManager.showNotification(`–ü–µ—Ä–µ—Ö–æ–¥ –∫: ${targetId}`, 'warning');
                // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ –µ–≥–æ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
            },
            
            // –†–µ–Ω–¥–µ—Ä –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
            renderMedia() {
                const gallery = document.getElementById('mediaGallery');
                gallery.innerHTML = '';
                
                if (!this.currentItem.media || this.currentItem.media.length === 0) {
                    gallery.innerHTML = '<p style="text-align: center; color: #6c757d;">–ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>';
                    return;
                }
                
                this.currentItem.media.forEach((media, index) => {
                    const mediaItem = document.createElement('div');
                    mediaItem.className = 'media-item';
                    
                    if (media.type === 'image') {
                        mediaItem.innerHTML = `
                            <img src="${media.data}" alt="${media.name}">
                            <div class="media-item-actions">
                                <button onclick="knowledgeManager.deleteMedia(${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                                <button onclick="knowledgeManager.insertMediaToEditor('${media.data}', '${media.type}')" title="–í—Å—Ç–∞–≤–∏—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä">üìù</button>
                            </div>
                        `;
                    } else if (media.type === 'video') {
                        mediaItem.innerHTML = `
                            <video controls>
                                <source src="${media.data}" type="${media.mimeType}">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                            </video>
                            <div class="media-item-actions">
                                <button onclick="knowledgeManager.deleteMedia(${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                                <button onclick="knowledgeManager.insertMediaToEditor('${media.data}', '${media.type}')" title="–í—Å—Ç–∞–≤–∏—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä">üìù</button>
                            </div>
                        `;
                    }
                    
                    gallery.appendChild(mediaItem);
                });
            },
            
            // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ —Å—Å—ã–ª–æ–∫
            renderLinks() {
                const linksList = document.getElementById('linksList');
                linksList.innerHTML = '';
                
                // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Å—ã–ª–æ–∫
                const allTech = this.getAllTechnologies();
                
                if (allTech.length === 0) {
                    linksList.innerHTML = '<p style="text-align: center; color: #6c757d;">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                    return;
                }
                
                allTech.forEach(tech => {
                    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
                    if (tech === this.currentItem) return;
                    
                    const isLinked = this.currentItem.links && 
                                    this.currentItem.links.some(link => link.id === tech.id);
                    
                    const linkItem = document.createElement('div');
                    linkItem.className = 'link-item';
                    linkItem.innerHTML = `
                        <span>${tech.name}</span>
                        <button onclick="knowledgeManager.toggleLink('${tech.id}')" 
                                class="${isLinked ? 'success' : ''}">
                            ${isLinked ? '‚úÖ' : 'üîó'}
                        </button>
                    `;
                    
                    linksList.appendChild(linkItem);
                });
            },
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
            getAllTechnologies() {
                const technologies = [];
                
                function traverse(nodes) {
                    nodes.forEach(node => {
                        if (node.type === 'technology') {
                            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                            if (!node.id) {
                                node.id = 'tech_' + Math.random().toString(36).substr(2, 9);
                            }
                            technologies.push(node);
                        }
                        
                        if (node.children) {
                            traverse(node.children);
                        }
                    });
                }
                
                traverse(techData.categories);
                return technologies;
            },
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏
            toggleLink(techId) {
                if (!this.currentItem.links) {
                    this.currentItem.links = [];
                }
                
                const existingIndex = this.currentItem.links.findIndex(link => link.id === techId);
                
                if (existingIndex >= 0) {
                    // –£–¥–∞–ª—è–µ–º —Å—Å—ã–ª–∫—É
                    this.currentItem.links.splice(existingIndex, 1);
                } else {
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É
                    const targetTech = this.findTechnologyById(techId);
                    if (targetTech) {
                        this.currentItem.links.push({
                            id: techId,
                            name: targetTech.name,
                            path: this.getPathToTechnology(targetTech)
                        });
                    }
                }
                
                this.renderLinks();
                this.scheduleSave();
            },
            
            // –ü–æ–∏—Å–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ø–æ ID
            findTechnologyById(id) {
                function findInNodes(nodes) {
                    for (const node of nodes) {
                        if (node.id === id) {
                            return node;
                        }
                        
                        if (node.children) {
                            const found = findInNodes(node.children);
                            if (found) return found;
                        }
                    }
                    return null;
                }
                
                return findInNodes(techData.categories);
            },
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
            getPathToTechnology(tech) {
                // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—É—Ç—å –∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö
                // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –ø–æ –≤—Å–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ –Ω–∞–π—Ç–∏ –ø—É—Ç—å
                return [];
            },
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞
            deleteMedia(index) {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –º–µ–¥–∏–∞—Ñ–∞–π–ª?')) {
                    this.currentItem.media.splice(index, 1);
                    this.renderMedia();
                    this.scheduleSave();
                }
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ –º–µ–¥–∏–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
            insertMediaToEditor(data, type) {
                let insertHtml = '';
                
                if (type === 'image') {
                    insertHtml = `<img src="${data}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" style="max-width: 100%;">`;
                } else if (type === 'video') {
                    insertHtml = `<video controls style="max-width: 100%;"><source src="${data}"></video>`;
                }
                
                enhancedEditor.insertHTML(insertHtml);
                this.switchTab('editor');
            },
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            saveContent() {
                if (!this.currentItem) return;
                
                this.currentItem.content = document.getElementById('enhancedEditor').innerHTML;
                this.scheduleSave();
                uiManager.showNotification('–ö–æ–Ω—Ç–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
            },
            
            // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
            showGlobalSearch() {
                uiManager.showModal('searchModal');
                document.getElementById('globalSearch').focus();
            },
            
            // –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
            performSearch() {
                const query = document.getElementById('globalSearch').value.toLowerCase();
                const results = document.getElementById('searchResults');
                results.innerHTML = '';
                
                if (!query) {
                    results.innerHTML = '<p style="text-align: center; color: #6c757d;">–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>';
                    return;
                }
                
                const searchResults = this.searchInKnowledgeBase(query);
                
                if (searchResults.length === 0) {
                    results.innerHTML = '<p style="text-align: center; color: #6c757d;">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
                    return;
                }
                
                searchResults.forEach(result => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'search-result-item';
                    resultItem.style.padding = '10px';
                    resultItem.style.borderBottom = '1px solid #e9ecef';
                    resultItem.style.cursor = 'pointer';
                    
                    resultItem.innerHTML = `
                        <div style="font-weight: bold;">${result.item.name}</div>
                        <div style="font-size: 0.9em; color: #6c757d;">${result.context}</div>
                    `;
                    
                    resultItem.onclick = () => {
                        this.openKnowledgeBase(JSON.stringify(result.path), result.index);
                        uiManager.hideModals();
                    };
                    
                    results.appendChild(resultItem);
                });
            },
            
            // –ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
            searchInKnowledgeBase(query) {
                const results = [];
                
                function searchInNodes(nodes, path = []) {
                    nodes.forEach((node, index) => {
                        // –ü–æ–∏—Å–∫ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
                        if (node.name.toLowerCase().includes(query)) {
                            results.push({
                                item: node,
                                path: [...path],
                                index: index,
                                context: `–ù–∞–∑–≤–∞–Ω–∏–µ: ${node.name}`
                            });
                        }
                        
                        // –ü–æ–∏—Å–∫ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ
                        if (node.content && node.content.toLowerCase().includes(query)) {
                            const contentPreview = node.content.replace(/<[^>]*>/g, '').substring(0, 100) + '...';
                            results.push({
                                item: node,
                                path: [...path],
                                index: index,
                                context: `–ö–æ–Ω—Ç–µ–Ω—Ç: ${contentPreview}`
                            });
                        }
                        
                        // –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –≤ –¥–µ—Ç—è—Ö
                        if (node.children) {
                            searchInNodes(node.children, [...path, index]);
                        }
                    });
                }
                
                searchInNodes(techData.categories);
                return results;
            },
            
            // –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            scheduleSave() {
                dataManager.saveToLocalStorage();
                authManager.scheduleAutoSave();
                accordionManager.renderAccordion();
            }
        };

        // Enhanced Editor
        const enhancedEditor = {
            isFullscreen: false,
            originalStyles: null,
            
            init() {
                this.setupEventListeners();
                this.setupFloatingToolbar();
                this.populateEmojiPicker();
                this.updateCharacterCount();
            },
            
            setupEventListeners() {
                const editor = document.getElementById('enhancedEditor');
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤
                editor.addEventListener('input', () => {
                    this.updateCharacterCount();
                });
                
                // –ü–ª–∞–≤–∞—é—â–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞
                editor.addEventListener('mouseup', (e) => {
                    const selection = window.getSelection();
                    if (selection.toString().length > 0) {
                        this.showFloatingToolbar(e);
                    }
                });
                
                // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
                editor.addEventListener('keydown', (e) => {
                    // Ctrl+B - –∂–∏—Ä–Ω—ã–π
                    if (e.ctrlKey && e.key === 'b') {
                        e.preventDefault();
                        this.toggleStyle('bold');
                    }
                    // Ctrl+I - –∫—É—Ä—Å–∏–≤
                    if (e.ctrlKey && e.key === 'i') {
                        e.preventDefault();
                        this.toggleStyle('italic');
                    }
                    // Ctrl+U - –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ
                    if (e.ctrlKey && e.key === 'u') {
                        e.preventDefault();
                        this.toggleStyle('underline');
                    }
                    // Ctrl+K - –≤—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É
                    if (e.ctrlKey && e.key === 'k') {
                        e.preventDefault();
                        this.showLinkModal();
                    }
                });
            },
            
            setupFloatingToolbar() {
                const toolbar = document.getElementById('floatingToolbar');
                toolbar.innerHTML = `
                    <button onclick="enhancedEditor.toggleStyle('bold')"><i class="fas fa-bold"></i></button>
                    <button onclick="enhancedEditor.toggleStyle('italic')"><i class="fas fa-italic"></i></button>
                    <button onclick="enhancedEditor.toggleStyle('underline')"><i class="fas fa-underline"></i></button>
                    <button onclick="enhancedEditor.showLinkModal()"><i class="fas fa-link"></i></button>
                    <button onclick="enhancedEditor.setHeading('h2')"><i class="fas fa-heading"></i></button>
                    <button onclick="enhancedEditor.insertList('ul')"><i class="fas fa-list-ul"></i></button>
                `;
            },
            
            showFloatingToolbar(e) {
                const toolbar = document.getElementById('floatingToolbar');
                const rect = e.target.getBoundingClientRect();
                
                toolbar.style.display = 'flex';
                toolbar.style.top = (e.clientY - rect.top - 50) + 'px';
                toolbar.style.left = (e.clientX - rect.left) + 'px';
                
                // –°–∫—Ä—ã—Ç—å –ø–ª–∞–≤–∞—é—â—É—é –ø–∞–Ω–µ–ª—å —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    toolbar.style.display = 'none';
                }, 3000);
            },
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
            toggleStyle(style) {
                document.execCommand(style, false, null);
                this.updateCharacterCount();
            },
            
            setAlignment(alignment) {
                document.execCommand('justify' + alignment.charAt(0).toUpperCase() + alignment.slice(1), false, null);
            },
            
            setFontFamily(font) {
                if (font) {
                    document.execCommand('fontName', false, font);
                }
            },
            
            setFontSize(size) {
                if (size) {
                    document.execCommand('fontSize', false, size);
                }
            },
            
            setTextColor(color) {
                document.execCommand('foreColor', false, color);
            },
            
            setBackgroundColor(color) {
                document.execCommand('backColor', false, color);
            },
            
            setHeading(level) {
                if (level === 'p') {
                    document.execCommand('formatBlock', false, '<p>');
                } else {
                    document.execCommand('formatBlock', false, '<' + level + '>');
                }
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            insertList(type) {
                document.execCommand(type === 'ul' ? 'insertUnorderedList' : 'insertOrderedList');
            },
            
            indent() {
                document.execCommand('indent', false, null);
            },
            
            outdent() {
                document.execCommand('outdent', false, null);
            },
            
            showLinkModal() {
                const selection = window.getSelection();
                const selectedText = selection.toString();
                
                if (selectedText) {
                    document.getElementById('linkText').value = selectedText;
                }
                
                uiManager.showModal('linkModal');
            },
            
            insertLink() {
                const url = document.getElementById('linkUrl').value;
                const text = document.getElementById('linkText').value || url;
                
                if (url) {
                    const html = `<a href="${url}" target="_blank" rel="noopener">${text}</a>`;
                    this.insertHTML(html);
                }
                
                uiManager.hideModals();
            },
            
            showImageModal() {
                uiManager.showModal('imageModal');
            },
            
            insertImage() {
                const url = document.getElementById('imageUrl').value;
                const alt = document.getElementById('imageAlt').value || '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';
                
                if (url) {
                    const html = `<img src="${url}" alt="${alt}" style="max-width: 100%; border-radius: 5px; margin: 10px 0;">`;
                    this.insertHTML(html);
                }
                
                uiManager.hideModals();
            },
            
            insertTable() {
                const rows = prompt('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫:', '3');
                const cols = prompt('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤:', '3');
                
                if (rows && cols) {
                    let tableHTML = '<table class="editor-table"><thead><tr>';
                    
                    // –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
                    for (let i = 0; i < cols; i++) {
                        tableHTML += `<th>–ó–∞–≥–æ–ª–æ–≤–æ–∫ ${i + 1}</th>`;
                    }
                    tableHTML += '</tr></thead><tbody>';
                    
                    // –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã
                    for (let i = 0; i < rows; i++) {
                        tableHTML += '<tr>';
                        for (let j = 0; j < cols; j++) {
                            tableHTML += `<td>–Ø—á–µ–π–∫–∞ ${i + 1}-${j + 1}</td>`;
                        }
                        tableHTML += '</tr>';
                    }
                    
                    tableHTML += '</tbody></table>';
                    this.insertHTML(tableHTML);
                }
            },
            
            insertCode() {
                const language = prompt('–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):', 'javascript');
                const code = prompt('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥:');
                
                if (code) {
                    const langAttr = language ? ` data-language="${language}"` : '';
                    const html = `<div class="editor-code"${langAttr}><pre><code>${this.escapeHTML(code)}</code></pre></div>`;
                    this.insertHTML(html);
                }
            },
            
            insertHorizontalRule() {
                this.insertHTML('<hr style="border: 1px solid #ddd; margin: 20px 0;">');
            },
            
            insertSpecialChar() {
                const char = prompt('–í–≤–µ–¥–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª –∏–ª–∏ HTML entity:');
                if (char) {
                    this.insertHTML(char);
                }
            },
            
            showEmojiPicker() {
                uiManager.showModal('emojiModal');
            },
            
            populateEmojiPicker() {
                const emojis = ['üòÄ', 'üòÇ', 'ü•∞', 'üòé', 'ü§î', 'üôÇ', 'üòä', 'ü§©', 'üòç', 'ü§ó', 
                               'üëç', 'üëé', '‚ù§Ô∏è', 'üî•', '‚≠ê', 'üéâ', 'üí°', 'üìö', '‚ö°', 'üîß',
                               'üìù', 'üîç', 'üíª', 'üì±', 'üåê', 'üöÄ', 'üíæ', 'üìä', 'üîí', 'üìÖ'];
                
                const picker = document.getElementById('emojiPicker');
                picker.innerHTML = '';
                
                emojis.forEach(emoji => {
                    const emojiElement = document.createElement('div');
                    emojiElement.className = 'emoji';
                    emojiElement.textContent = emoji;
                    emojiElement.onclick = () => {
                        this.insertHTML(emoji);
                        uiManager.hideModals();
                    };
                    picker.appendChild(emojiElement);
                });
            },
            
            // –£—Ç–∏–ª–∏—Ç—ã
            insertHTML(html) {
                const selection = window.getSelection();
                
                if (selection.rangeCount) {
                    const range = selection.getRangeAt(0);
                    range.deleteContents();
                    
                    const div = document.createElement('div');
                    div.innerHTML = html;
                    const fragment = document.createDocumentFragment();
                    
                    while (div.firstChild) {
                        fragment.appendChild(div.firstChild);
                    }
                    
                    range.insertNode(fragment);
                } else {
                    document.getElementById('enhancedEditor').innerHTML += html;
                }
                
                this.updateCharacterCount();
            },
            
            escapeHTML(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            },
            
            clearFormatting() {
                document.execCommand('removeFormat', false, null);
                document.execCommand('unlink', false, null);
            },
            
            updateCharacterCount() {
                const editor = document.getElementById('enhancedEditor');
                const text = editor.innerText || '';
                const words = text.trim() ? text.trim().split(/\s+/).length : 0;
                const characters = text.length;
                
                document.getElementById('wordCount').textContent = words + ' —Å–ª–æ–≤';
                document.getElementById('charCount').textContent = characters + ' —Å–∏–º–≤–æ–ª–æ–≤';
            },
            
            // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
            toggleFullscreen() {
                const editor = document.getElementById('enhancedEditor');
                const toolbar = document.getElementById('enhancedToolbar');
                
                if (!this.isFullscreen) {
                    // –í—Ö–æ–¥ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
                    this.originalStyles = {
                        height: editor.style.height,
                        overflow: editor.style.overflow
                    };
                    
                    editor.style.height = 'calc(100vh - 150px)';
                    editor.style.overflow = 'auto';
                    toolbar.style.position = 'sticky';
                    toolbar.style.top = '0';
                    toolbar.style.zIndex = '1000';
                    
                    this.isFullscreen = true;
                } else {
                    // –í—ã—Ö–æ–¥ –∏–∑ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º
