<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technologies Knowledge Base - Accordion View</title>
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        body {
            font-family: Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .auth-section {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
        }

        .auth-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }

        .auth-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .auth-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .controls {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            margin: 2px;
        }

        button:hover {
            background: #0056b3;
        }

        button.delete {
            background: #dc3545;
        }

        button.delete:hover {
            background: #c82333;
        }

        button.success {
            background: #28a745;
        }

        button.success:hover {
            background: #218838;
        }

        button.warning {
            background: #ffc107;
            color: black;
        }

        button.warning:hover {
            background: #e0a800;
        }

        input, textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 5px 0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 5px;
            color: white;
            z-index: 1001;
        }

        .success { background: #28a745; }
        .error { background: #dc3545; }
        .warning { background: #ffc107; color: black; }

        .accordion-container {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
            min-height: 500px;
            overflow: auto;
        }

        .hidden {
            display: none;
        }

        .checklist-section {
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .checklist-item:last-child {
            border-bottom: none;
        }

        .checklist-item input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .checklist-item-text {
            flex-grow: 1;
        }

        .checklist-item.completed .checklist-item-text {
            text-decoration: line-through;
            color: #6c757d;
        }

        .checklist-stats {
            margin-top: 10px;
            padding: 8px;
            background: #e9ecef;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .checklist-actions {
            margin-top: 10px;
        }

        .checklist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .checklist-title {
            font-weight: bold;
            font-size: 1.1em;
        }

        button.auto-save-enabled {
            background: #28a745;
        }

        button.auto-save-enabled:hover {
            background: #218838;
        }

        button.auto-save-disabled {
            background: #6c757d;
        }

        button.auto-save-disabled:hover {
            background: #5a6268;
        }

        .auto-save-status {
            display: inline-block;
            margin-left: 10px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        .auto-save-on {
            background: #d4edda;
            color: #155724;
        }

        .auto-save-off {
            background: #f8d7da;
            color: #721c24;
        }

        .path-display {
            font-size: 0.8em;
            color: #6c757d;
            margin-left: 10px;
            font-style: italic;
        }

        .parent-select-item {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            background: #f8f9fa;
        }

        .parent-select-item:hover {
            background: #e9ecef;
        }

        .parent-select-item.selected {
            background: #007bff;
            color: white;
            border-color: #0056b3;
        }

        /* –ê–∫–∫–æ—Ä–¥–µ–æ–Ω —Å—Ç–∏–ª–∏ */
        .accordion {
            width: 100%;
        }

        .accordion-item {
            margin-bottom: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        .accordion-header {
            padding: 12px 15px;
            background: #f8f9fa;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
            user-select: none;
        }

        .accordion-header:hover {
            background: #e9ecef;
        }

        .accordion-header.category {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
        }

        .accordion-header.technology {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
        }

        .accordion-title {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-grow: 1;
        }

        .accordion-icon {
            font-size: 1.2em;
        }

        .accordion-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: white;
        }

        .accordion-content.expanded {
            max-height: 5000px;
        }

        .accordion-child {
            margin-left: 30px;
            border-left: 2px solid #e9ecef;
        }

        .accordion-stats {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-right: 10px;
        }

        .accordion-progress {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .accordion-actions {
            display: flex;
            gap: 5px;
        }

        .accordion-toggle {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .progress-bar {
            width: 100px;
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin: 5px 0;
        }

        .progress-fill {
            height: 100%;
            background-color: #20c997;
            transition: width 0.3s ease;
        }

        .status-planned { color: #6c757d; }
        .status-in-progress { color: #fd7e14; }
        .status-completed { color: #198754; }

        .checklist-indicator {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 2px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —á–µ–∫-–ª–∏—Å—Ç–∞ */
        .inline-checklist {
            padding: 15px;
            border-top: 1px solid #e9ecef;
            background: #f8f9fa;
        }

        .inline-checklist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .inline-checklist-title {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .inline-checklist-toggle {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
        }

        .inline-checklist-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .inline-checklist-content.expanded {
            max-height: 1000px;
        }

        .inline-checklist-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .inline-checklist-item:last-child {
            border-bottom: none;
        }

        .inline-checklist-item input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .inline-checklist-item-text {
            flex-grow: 1;
            font-size: 0.9em;
        }

        .inline-checklist-item.completed .inline-checklist-item-text {
            text-decoration: line-through;
            color: #6c757d;
        }

        .inline-checklist-stats {
            padding: 8px;
            background: #e9ecef;
            border-radius: 4px;
            font-size: 0.8em;
            margin-top: 10px;
        }

        .inline-checklist-actions {
            margin-top: 10px;
            display: flex;
            gap: 5px;
        }

        .technology-checkbox {
            margin-left: 10px;
        }

        .technology-checkbox input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
        }

        .sync-status {
            margin-top: 10px;
            padding: 8px;
            background: #e9ecef;
            border-radius: 4px;
            font-size: 0.9em;
            color: #6c757d;
        }

        /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –°–ò–°–¢–ï–ú–´ –ó–ù–ê–ù–ò–ô */
        
        /* –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .content-editor {
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .editor-toolbar {
            background: #f8f9fa;
            padding: 8px;
            border-bottom: 1px solid #ddd;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .toolbar-group {
            display: flex;
            border-right: 1px solid #ddd;
            padding-right: 5px;
            margin-right: 5px;
        }
        
        .toolbar-group:last-child {
            border-right: none;
        }
        
        .editor-toolbar button {
            background: white;
            color: #333;
            border: 1px solid #ddd;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .editor-toolbar button:hover {
            background: #e9ecef;
        }
        
        .editor-content {
            min-height: 300px;
            padding: 15px;
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        
        .editor-content:focus {
            outline: none;
        }
        
        .editor-status {
            display: flex;
            gap: 15px;
            padding: 8px 15px;
            background: #f8f9fa;
            border-top: 1px solid #ddd;
            font-size: 0.8em;
            color: #6c757d;
        }
        
        /* –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .knowledge-content {
            padding: 15px;
            line-height: 1.6;
        }
        
        .knowledge-content h1, 
        .knowledge-content h2, 
        .knowledge-content h3, 
        .knowledge-content h4 {
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            color: #2c3e50;
        }
        
        .knowledge-content h1 { font-size: 1.8em; border-bottom: 2px solid #3498db; padding-bottom: 5px; }
        .knowledge-content h2 { font-size: 1.5em; border-bottom: 1px solid #bdc3c7; padding-bottom: 3px; }
        .knowledge-content h3 { font-size: 1.3em; }
        .knowledge-content h4 { font-size: 1.1em; }
        
        .knowledge-content p {
            margin-bottom: 1em;
        }
        
        .knowledge-content ul, 
        .knowledge-content ol {
            margin-bottom: 1em;
            padding-left: 2em;
        }
        
        .knowledge-content blockquote {
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin: 1em 0;
            color: #7f8c8d;
            font-style: italic;
        }
        
        .knowledge-content code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .knowledge-content pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 1em 0;
        }
        
        .knowledge-content pre code {
            background: none;
            padding: 0;
            color: inherit;
        }
        
        .knowledge-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1em 0;
        }
        
        .knowledge-content table, 
        .knowledge-content th, 
        .knowledge-content td {
            border: 1px solid #bdc3c7;
        }
        
        .knowledge-content th, 
        .knowledge-content td {
            padding: 8px 12px;
            text-align: left;
        }
        
        .knowledge-content th {
            background: #f8f9fa;
        }
        
        .knowledge-content img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
            margin: 10px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .knowledge-content video {
            max-width: 100%;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .internal-link {
            color: #3498db;
            text-decoration: none;
            border-bottom: 1px dashed #3498db;
            cursor: pointer;
        }
        
        .internal-link:hover {
            color: #2980b9;
            border-bottom: 1px solid #2980b9;
        }
        
        .media-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .media-item {
            position: relative;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .media-item img, 
        .media-item video {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .media-item-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
        }
        
        .media-item-actions button {
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            border-radius: 3px;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        
        .media-actions {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .linked-items {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .linked-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            margin: 5px 0;
            background: white;
            border-radius: 4px;
            border-left: 4px solid #3498db;
        }
        
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .template-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }
        
        .template-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-color: #3498db;
        }
        
        .template-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .template-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .template-desc {
            font-size: 0.8em;
            color: #6c757d;
        }
        
        .content-block {
            margin: 15px 0;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid;
        }
        
        .block-note {
            background: #e3f2fd;
            border-left-color: #2196f3;
        }
        
        .block-warning {
            background: #fff3e0;
            border-left-color: #ff9800;
        }
        
        .block-tip {
            background: #e8f5e9;
            border-left-color: #4caf50;
        }
        
        .history-item {
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .internal-link-item {
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
            cursor: pointer;
        }
        
        .internal-link-item:hover {
            background: #f8f9fa;
        }
        
        .internal-link-item:last-child {
            border-bottom: none;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –∑–Ω–∞–Ω–∏–π */
        .knowledge-modal .modal-content {
            max-width: 900px;
            max-height: 90vh;
        }
        
        .content-tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
        }
        
        .content-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .content-tab.active {
            border-bottom: 2px solid #3498db;
            color: #3498db;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .media-upload-area {
            border: 2px dashed #bdc3c7;
            border-radius: 5px;
            padding: 30px;
            text-align: center;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .media-upload-area:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }
        
        .media-upload-area.dragover {
            border-color: #3498db;
            background: #e3f2fd;
        }
        
        .links-panel {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .link-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .link-item:last-child {
            border-bottom: none;
        }
        
        .search-box {
            margin: 10px 0;
            position: relative;
        }
        
        .search-box input {
            padding-right: 35px;
        }
        
        .search-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
        
        .knowledge-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .content-preview {
            max-height: 200px;
            overflow: hidden;
            position: relative;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #e9ecef;
            border-radius: 5px;
        }
        
        .content-preview:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(transparent, white);
        }
        
        .knowledge-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: #e3f2fd;
            color: #1976d2;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-left: 10px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö Technologies Knowledge Base - Accordion View</h1>
        
        <!-- –°–µ–∫—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
        <div class="auth-section" id="authSection">
            <h3>üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ GitHub</h3>
            <div>
                <input type="password" id="githubToken" placeholder="GitHub Personal Access Token" style="width: 300px;">
                <input type="text" id="repoOwner" placeholder="–í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è" style="width: 150px;">
                <input type="text" id="repoName" placeholder="–ò–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è" style="width: 150px;">
                <button onclick="authManager.saveAuth()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <button onclick="authManager.testAuth()" class="success">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
            </div>
            <div id="syncStatus" class="sync-status"></div>
            <div id="authStatus" class="auth-status"></div>
            <p><small>–¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ. –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ GitHub —Å –ø—Ä–∞–≤–∞–º–∏ repo</small></p>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã -->
        <div class="controls">
            <div>
                <button onclick="uiManager.showModal('categoryModal')">+ –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                <button onclick="uiManager.showAddNodeModal()">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                <button onclick="uiManager.showAddTechModal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é</button>
                <button onclick="authManager.loadFromGitHub()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å GitHub</button>
                <button onclick="authManager.saveToGitHub()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ GitHub</button>
                <button onclick="authManager.forceSync()">üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</button>
                <button onclick="authManager.toggleAutoSave()" id="autoSaveBtn">üö´ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</button>
                <button onclick="dataManager.exportToJSON()">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON</button>
                <button onclick="dataManager.importFromJSON()">üì§ –ò–º–ø–æ—Ä—Ç –∏–∑ JSON</button>
                <button onclick="knowledgeManager.showGlobalSearch()" class="success">üîç –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π</button>
            </div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ -->
        <div id="accordionContainer" class="accordion-container">
            <div id="accordion" class="accordion"></div>
        </div>

        <!-- –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
        <div id="categoryModal" class="modal">
            <div class="modal-content">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
                <input type="text" id="newCategoryName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏">
                <div>
                    <button onclick="dataManager.addCategory()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <div id="nodeModal" class="modal">
            <div class="modal-content">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
                <div id="nodeParentSelect">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π –≤—ã–±–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—è -->
                </div>
                <input type="text" id="newNodeName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏">
                <div>
                    <button onclick="dataManager.addNode()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <div id="techModal" class="modal">
            <div class="modal-content">
                <h3>–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é</h3>
                <div id="techParentSelect">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π –≤—ã–±–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—è -->
                </div>
                <input type="text" id="newTechName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">
                <div>
                    <button onclick="dataManager.addTechnology()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–º -->
        <div id="checklistModal" class="modal">
            <div class="modal-content">
                <div class="checklist-header">
                    <h3 id="checklistTitle">–ß–µ–∫-–ª–∏—Å—Ç</h3>
                    <button onclick="uiManager.hideModals()">‚úï</button>
                </div>
                
                <div class="checklist-stats" id="checklistStats">
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
                
                <div id="checklistItems">
                    <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —á–µ–∫-–ª–∏—Å—Ç–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                
                <div class="checklist-actions">
                    <input type="text" id="newChecklistItem" placeholder="–ù–æ–≤—ã–π –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç–∞" style="width: calc(100% - 100px);">
                    <button onclick="checklistManager.addChecklistItem()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                
                <div style="margin-top: 15px;">
                    <button onclick="checklistManager.saveChecklist()" class="success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ–∫-–ª–∏—Å—Ç</button>
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <!-- –£–õ–£–ß–®–ï–ù–ù–û–ï –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –°–ò–°–¢–ï–ú–´ –ó–ù–ê–ù–ò–ô -->
        <div id="knowledgeModal" class="modal knowledge-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="knowledgeTitle">–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</h3>
                    <button onclick="uiManager.hideModals()">‚úï</button>
                </div>
                
                <div class="content-tabs">
                    <div class="content-tab active" onclick="knowledgeManager.switchTab('editor')">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä</div>
                    <div class="content-tab" onclick="knowledgeManager.switchTab('preview')">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä</div>
                    <div class="content-tab" onclick="knowledgeManager.switchTab('media')">üñºÔ∏è –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã</div>
                    <div class="content-tab" onclick="knowledgeManager.switchTab('links')">üîó –°—Å—ã–ª–∫–∏</div>
                    <div class="content-tab" onclick="knowledgeManager.switchTab('templates')">üìã –®–∞–±–ª–æ–Ω—ã</div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
                <div id="editorTab" class="tab-content active">
                    <div class="content-editor">
                        <div class="editor-toolbar">
                            <div class="toolbar-group">
                                <button onclick="knowledgeEditor.formatText('bold')" title="–ñ–∏—Ä–Ω—ã–π"><b>B</b></button>
                                <button onclick="knowledgeEditor.formatText('italic')" title="–ö—É—Ä—Å–∏–≤"><i>I</i></button>
                                <button onclick="knowledgeEditor.formatText('underline')" title="–ü–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ"><u>U</u></button>
                                <button onclick="knowledgeEditor.formatText('strikeThrough')" title="–ó–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π"><s>S</s></button>
                            </div>
                            
                            <div class="toolbar-group">
                                <button onclick="knowledgeEditor.insertHeading(1)" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ 1">H1</button>
                                <button onclick="knowledgeEditor.insertHeading(2)" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ 2">H2</button>
                                <button onclick="knowledgeEditor.insertHeading(3)" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ 3">H3</button>
                                <button onclick="knowledgeEditor.insertHeading(4)" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ 4">H4</button>
                            </div>
                            
                            <div class="toolbar-group">
                                <button onclick="knowledgeEditor.insertList('ul')" title="–ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫">‚Ä¢</button>
                                <button onclick="knowledgeEditor.insertList('ol')" title="–ù—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫">1.</button>
                                <button onclick="knowledgeEditor.insertBlockquote()" title="–¶–∏—Ç–∞—Ç–∞">‚ùù</button>
                            </div>
                            
                            <div class="toolbar-group">
                                <button onclick="knowledgeEditor.insertLink()" title="–í—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É">üîó</button>
                                <button onclick="knowledgeEditor.showInternalLinkModal()" title="–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å—Å—ã–ª–∫–∞">üìé</button>
                                <button onclick="knowledgeEditor.insertCode()" title="–í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–¥">{"{}"}</button>
                            </div>
                            
                            <div class="toolbar-group">
                                <button onclick="knowledgeEditor.insertTable()" title="–í—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É">‚ß†</button>
                                <button onclick="knowledgeEditor.insertImage()" title="–í—Å—Ç–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">üñºÔ∏è</button>
                                <button onclick="knowledgeEditor.insertVideo()" title="–í—Å—Ç–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ">üé¨</button>
                            </div>
                            
                            <div class="toolbar-group">
                                <button onclick="knowledgeEditor.insertTemplate('note')" title="–ë–ª–æ–∫ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è">üìù</button>
                                <button onclick="knowledgeEditor.insertTemplate('warning')" title="–ë–ª–æ–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è">‚ö†Ô∏è</button>
                                <button onclick="knowledgeEditor.insertTemplate('tip')" title="–ë–ª–æ–∫ —Å–æ–≤–µ—Ç–∞">üí°</button>
                            </div>
                            
                            <div class="toolbar-group">
                                <select onchange="knowledgeEditor.changeFontSize(this.value)" title="–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞">
                                    <option value="">–†–∞–∑–º–µ—Ä</option>
                                    <option value="1">–ú–µ–ª–∫–∏–π</option>
                                    <option value="3">–ù–æ—Ä–º–∞–ª—å–Ω—ã–π</option>
                                    <option value="5">–ö—Ä—É–ø–Ω—ã–π</option>
                                    <option value="7">–û—á–µ–Ω—å –∫—Ä—É–ø–Ω—ã–π</option>
                                </select>
                                
                                <select onchange="knowledgeEditor.changeFontFamily(this.value)" title="–®—Ä–∏—Ñ—Ç">
                                    <option value="">–®—Ä–∏—Ñ—Ç</option>
                                    <option value="Arial">Arial</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="'Courier New'">Courier New</option>
                                    <option value="'Times New Roman'">Times New Roman</option>
                                </select>
                            </div>
                            
                            <div class="toolbar-group">
                                <button onclick="knowledgeEditor.undo()" title="–û—Ç–º–µ–Ω–∏—Ç—å">‚Ü∂</button>
                                <button onclick="knowledgeEditor.redo()" title="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å">‚Ü∑</button>
                                <button onclick="knowledgeEditor.clearFormatting()" title="–û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ">üßπ</button>
                            </div>
                        </div>
                        <div id="knowledgeEditor" class="editor-content" contenteditable="true"></div>
                    </div>
                    
                    <div class="editor-status">
                        <span id="editorWordCount">–°–ª–æ–≤: 0</span>
                        <span id="editorCharCount">–°–∏–º–≤–æ–ª–æ–≤: 0</span>
                        <span id="editorReadTime">–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è: 0 –º–∏–Ω</span>
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
                <div id="previewTab" class="tab-content">
                    <div id="knowledgePreview" class="knowledge-content"></div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ -->
                <div id="mediaTab" class="tab-content">
                    <div class="media-upload-area" id="mediaDropZone">
                        üìÅ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –≤–∏–¥–µ–æ<br>
                        <small>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤</small>
                        <input type="file" id="mediaUpload" multiple accept="image/*,video/*" style="display: none;">
                    </div>
                    <div class="media-actions">
                        <button onclick="knowledgeManager.browseMediaLibrary()">üìö –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –º–µ–¥–∏–∞</button>
                        <button onclick="knowledgeManager.downloadAllMedia()">üì• –°–∫–∞—á–∞—Ç—å –≤—Å–µ –º–µ–¥–∏–∞</button>
                    </div>
                    <div id="mediaGallery" class="media-gallery">
                        <!-- –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ —Å—Å—ã–ª–æ–∫ -->
                <div id="linksTab" class="tab-content">
                    <div class="search-box">
                        <input type="text" id="linkSearch" placeholder="–ü–æ–∏—Å–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π...">
                        <span class="search-icon">üîç</span>
                    </div>
                    <div id="linksList" class="links-panel">
                        <!-- –°–ø–∏—Å–æ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –¥–ª—è —Å—Å—ã–ª–æ–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                    <div class="linked-items">
                        <h4>–°–≤—è–∑–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:</h4>
                        <div id="linkedItemsList">
                            <!-- –°–≤—è–∑–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>
                
                <!-- –ù–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ -->
                <div id="templatesTab" class="tab-content">
                    <div class="templates-grid">
                        <div class="template-card" onclick="knowledgeEditor.insertTemplate('cheatsheet')">
                            <div class="template-icon">üìã</div>
                            <div class="template-title">–®–ø–∞—Ä–≥–∞–ª–∫–∞</div>
                            <div class="template-desc">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–º–µ—Ç–æ–∫ –∏ –∫–æ–º–∞–Ω–¥</div>
                        </div>
                        
                        <div class="template-card" onclick="knowledgeEditor.insertTemplate('tutorial')">
                            <div class="template-icon">üìö</div>
                            <div class="template-title">–û–±—É—á–µ–Ω–∏–µ</div>
                            <div class="template-desc">–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏</div>
                        </div>
                        
                        <div class="template-card" onclick="knowledgeEditor.insertTemplate('comparison')">
                            <div class="template-icon">‚öñÔ∏è</div>
                            <div class="template-title">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ</div>
                            <div class="template-desc">–¢–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π</div>
                        </div>
                        
                        <div class="template-card" onclick="knowledgeEditor.insertTemplate('faq')">
                            <div class="template-icon">‚ùì</div>
                            <div class="template-title">FAQ</div>
                            <div class="template-desc">–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</div>
                        </div>
                        
                        <div class="template-card" onclick="knowledgeEditor.insertTemplate('reference')">
                            <div class="template-icon">üìñ</div>
                            <div class="template-title">–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫</div>
                            <div class="template-desc">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</div>
                        </div>
                        
                        <div class="template-card" onclick="knowledgeEditor.insertTemplate('workflow')">
                            <div class="template-icon">üîß</div>
                            <div class="template-title">–ü—Ä–æ—Ü–µ—Å—Å</div>
                            <div class="template-desc">–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞</div>
                        </div>
                    </div>
                </div>
                
                <div class="knowledge-actions">
                    <div>
                        <button onclick="knowledgeManager.saveContent()" class="success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button onclick="knowledgeManager.exportContent()">üì• –≠–∫—Å–ø–æ—Ä—Ç</button>
                        <button onclick="knowledgeManager.importContent()">üì§ –ò–º–ø–æ—Ä—Ç</button>
                        <button onclick="knowledgeManager.showHistory()" title="–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π">üìú</button>
                    </div>
                    <button onclick="uiManager.hideModals()">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π -->
        <div id="searchModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üîç –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π</h3>
                    <button onclick="uiManager.hideModals()">‚úï</button>
                </div>
                <div class="search-box">
                    <input type="text" id="globalSearch" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å...">
                    <span class="search-icon">üîç</span>
                </div>
                <div id="searchResults" style="max-height: 400px; overflow-y: auto; margin-top: 15px;">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>

        <!-- –ù–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫ -->
        <div id="internalLinkModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üîó –í—Å—Ç–∞–≤–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Å—ã–ª–∫—É</h3>
                    <button onclick="uiManager.hideModals()">‚úï</button>
                </div>
                <div class="search-box">
                    <input type="text" id="internalLinkSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π...">
                    <span class="search-icon">üîç</span>
                </div>
                <div id="internalLinkResults" style="max-height: 400px; overflow-y: auto; margin-top: 15px;">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                <div style="margin-top: 15px; text-align: right;">
                    <button onclick="uiManager.hideModals()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
        <div id="historyModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üìú –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π</h3>
                    <button onclick="uiManager.hideModals()">‚úï</button>
                </div>
                <div id="historyList" style="max-height: 400px; overflow-y: auto;">
                    <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
                <div style="margin-top: 15px; text-align: right;">
                    <button onclick="uiManager.hideModals()">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –¥–ª—è JSON -->
        <div id="jsonSection" class="hidden">
            <h3>JSON –¥–∞–Ω–Ω—ã–µ:</h3>
            <textarea id="jsonOutput" style="width: 100%; height: 200px;"></textarea>
            <div>
                <button onclick="dataManager.copyToClipboard()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON</button>
                <button onclick="dataManager.importFromJSONText()">üì§ –ò–º–ø–æ—Ä—Ç –∏–∑ —ç—Ç–æ–≥–æ JSON</button>
                <button onclick="uiManager.hideJSON()">–°–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ -->
        <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å—é
        const techData = {
            categories: []
        };

        // –¢–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—É—Ç—å –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        let currentModalPath = [];

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        let lastKnownRemoteSha = null;
        let lastSyncTime = null;

        // –¢–µ–∫—É—â–∏–π —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –∑–Ω–∞–Ω–∏–π
        let currentKnowledgeItem = null;

        // === –ú–ï–ù–ï–î–ñ–ï–† –ê–ö–ö–û–†–î–ï–û–ù–ê ===
        const accordionManager = {
            init() {
                this.accordionContainer = document.getElementById('accordion');
                this.expandedState = JSON.parse(localStorage.getItem('accordionExpandedState')) || {};
                this.checklistExpandedState = JSON.parse(localStorage.getItem('checklistExpandedState')) || {};
                this.renderAccordion();
            },

            renderAccordion() {
                if (!this.accordionContainer) {
                    console.error('Accordion container not found');
                    return;
                }
                
                this.accordionContainer.innerHTML = '';
                
                if (techData.categories.length === 0) {
                    this.accordionContainer.innerHTML = '<p style="text-align: center; color: #6c757d;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é!</p>';
                    return;
                }

                this.buildAccordion(techData.categories, this.accordionContainer, []);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è
                localStorage.setItem('accordionExpandedState', JSON.stringify(this.expandedState));
                localStorage.setItem('checklistExpandedState', JSON.stringify(this.checklistExpandedState));
            },

            buildAccordion(nodes, parentElement, path) {
                nodes.forEach((node, index) => {
                    const currentPath = [...path, index];
                    const pathKey = currentPath.join('-');
                    
                    // –ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –∑–∞–¥–∞–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–æ—Ä–Ω–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                    if (this.expandedState[pathKey] === undefined) {
                        this.expandedState[pathKey] = path.length === 0;
                    }
                    
                    const item = document.createElement('div');
                    item.className = 'accordion-item';
                    
                    // –†–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è —É–∑–ª–∞
                    const nodeProgress = this.calculateNodeProgress(node);
                    const progress = nodeProgress.progress;
                    const hasChecklistItems = nodeProgress.hasChecklistItems;
                    
                    let statusText = '';
                    let statusClass = '';
                    
                    if (node.type === 'technology') {
                        if (!hasChecklistItems) {
                            statusText = node.completed ? '‚úÖ –ò–∑—É—á–µ–Ω–æ' : 'üìù –í –ø–ª–∞–Ω–∞—Ö';
                            statusClass = node.completed ? 'status-completed' : 'status-planned';
                        } else {
                            if (progress === 0) {
                                statusText = 'üìù –í –ø–ª–∞–Ω–∞—Ö';
                                statusClass = 'status-planned';
                            } else if (progress === 100) {
                                statusText = '‚úÖ –ò–∑—É—á–µ–Ω–æ';
                                statusClass = 'status-completed';
                            } else {
                                statusText = 'üöß –í –ø—Ä–æ—Ü–µ—Å—Å–µ';
                                statusClass = 'status-in-progress';
                            }
                        }
                    } else {
                        // –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—á–µ—Ä–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                        if (progress === 0) {
                            statusText = 'üìù –ù–µ –Ω–∞—á–∞—Ç–æ';
                            statusClass = 'status-planned';
                        } else if (progress === 100) {
                            statusText = '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ';
                            statusClass = 'status-completed';
                        } else {
                            statusText = 'üöß –í –ø—Ä–æ—Ü–µ—Å—Å–µ';
                            statusClass = 'status-in-progress';
                        }
                    }

                    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
                    const header = document.createElement('div');
                    header.className = `accordion-header ${node.type === 'technology' ? 'technology' : 'category'}`;
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è/—Å–∫—Ä—ã—Ç–∏—è
                    header.onclick = (e) => {
                        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                        if (!e.target.closest('.accordion-actions') && !e.target.closest('.accordion-toggle') && 
                            !e.target.closest('.technology-checkbox')) {
                            this.toggleItem(pathKey);
                        }
                    };
                    
                    const title = document.createElement('div');
                    title.className = 'accordion-title';
                    
                    // –ò–∫–æ–Ω–∫–∞ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π/—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
                    const icon = document.createElement('span');
                    icon.className = 'accordion-icon';
                    icon.textContent = node.type === 'technology' ? '‚öôÔ∏è' : 'üìÅ';
                    title.appendChild(icon);
                    
                    // –ù–∞–∑–≤–∞–Ω–∏–µ
                    const name = document.createElement('span');
                    name.textContent = node.name;
                    name.style.fontWeight = 'bold';
                    title.appendChild(name);

                    // –ë–µ–π–¥–∂ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
                    if (node.content && node.content.length > 0) {
                        const badge = document.createElement('span');
                        badge.className = 'knowledge-badge';
                        badge.textContent = 'üìö';
                        badge.title = '–ï—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π';
                        title.appendChild(badge);
                    }
                    
                    header.appendChild(title);
                    
                    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
                    const stats = document.createElement('div');
                    stats.className = 'accordion-stats';
                    
                    const status = document.createElement('span');
                    status.className = statusClass;
                    status.textContent = statusText;
                    stats.appendChild(status);
                    
                    const progressContainer = document.createElement('div');
                    progressContainer.className = 'accordion-progress';
                    
                    const progressBar = document.createElement('div');
                    progressBar.className = 'progress-bar';
                    progressBar.style.width = '100px';
                    const progressFill = document.createElement('div');
                    progressFill.className = 'progress-fill';
                    progressFill.style.width = `${progress}%`;
                    progressBar.appendChild(progressFill);
                    progressContainer.appendChild(progressBar);
                    
                    const progressText = document.createElement('span');
                    progressText.textContent = `${Math.round(progress)}%`;
                    progressText.style.fontSize = '0.9em';
                    progressText.style.color = '#6c757d';
                    progressContainer.appendChild(progressText);
                    
                    stats.appendChild(progressContainer);
                    
                    // –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –±–µ–∑ —á–µ–∫-–ª–∏—Å—Ç–∞
                    if (node.type === 'technology' && (!node.checklist || node.checklist.length === 0)) {
                        const checkboxContainer = document.createElement('div');
                        checkboxContainer.className = 'technology-checkbox';
                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.checked = node.completed || false;
                        checkbox.onchange = (e) => {
                            node.completed = e.target.checked;
                            dataManager.saveToLocalStorage();
                            authManager.scheduleAutoSave();
                            this.renderAccordion();
                        };
                        checkboxContainer.appendChild(checkbox);
                        const label = document.createElement('span');
                        label.textContent = '–ò–∑—É—á–µ–Ω–æ';
                        label.style.fontSize = '0.9em';
                        checkboxContainer.appendChild(label);
                        stats.appendChild(checkboxContainer);
                    }
                    
                    header.appendChild(stats);
                    
                    // –î–µ–π—Å—Ç–≤–∏—è
                    const actions = document.createElement('div');
                    actions.className = 'accordion-actions';
                    
                    if (node.type === 'technology') {
                        actions.innerHTML = `
                            <button onclick="knowledgeManager.openKnowledgeBase('${JSON.stringify(path)}', ${index})" title="–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π" style="background: #9c27b0;">üìö</button>
                            <button onclick="checklistManager.manageChecklist('${JSON.stringify(path)}', ${index})" class="warning" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–æ–º">üìã</button>
                            <button onclick="dataManager.editTechnology('${JSON.stringify(path)}', ${index})" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</button>
                            <button class="delete" onclick="dataManager.deleteTechnology('${JSON.stringify(path)}', ${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                        `;
                    } else {
                        actions.innerHTML = `
                            <button onclick="uiManager.showAddNodeModal('${JSON.stringify(currentPath)}')" title="–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é">+ üìÅ</button>
                            <button onclick="uiManager.showAddTechModal('${JSON.stringify(currentPath)}')" title="–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é">+ ‚öôÔ∏è</button>
                            <button onclick="dataManager.editNode('${JSON.stringify(path)}', ${index})" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</button>
                            <button class="delete" onclick="dataManager.deleteNode('${JSON.stringify(path)}', ${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                        `;
                    }
                    
                    header.appendChild(actions);
                    
                    // –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
                    if (node.children && node.children.length > 0) {
                        const toggle = document.createElement('button');
                        toggle.className = 'accordion-toggle';
                        toggle.innerHTML = this.expandedState[pathKey] ? '‚ñº' : '‚ñ∫';
                        toggle.onclick = (e) => {
                            e.stopPropagation();
                            this.toggleItem(pathKey);
                        };
                        header.appendChild(toggle);
                    }
                    
                    item.appendChild(header);
                    
                    // –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ (–¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã)
                    if (node.children && node.children.length > 0) {
                        const content = document.createElement('div');
                        content.className = 'accordion-content';
                        if (this.expandedState[pathKey]) {
                            content.classList.add('expanded');
                        }
                        
                        const childContainer = document.createElement('div');
                        childContainer.className = 'accordion-child';
                        this.buildAccordion(node.children, childContainer, currentPath);
                        content.appendChild(childContainer);
                        
                        item.appendChild(content);
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π —Å –ø—É–Ω–∫—Ç–∞–º–∏
                    if (node.type === 'technology' && node.checklist && node.checklist.length > 0) {
                        const inlineChecklist = this.createInlineChecklist(node, path, index);
                        item.appendChild(inlineChecklist);
                    }
                    
                    parentElement.appendChild(item);
                });
            },
            
            toggleItem(pathKey) {
                this.expandedState[pathKey] = !this.expandedState[pathKey];
                this.renderAccordion();
            },
            
            createInlineChecklist(tech, path, index) {
                const checklistContainer = document.createElement('div');
                checklistContainer.className = 'inline-checklist';
                
                const checklistKey = path.join('-') + '-' + index;
                const isExpanded = this.checklistExpandedState[checklistKey] !== false; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞—Å–∫—Ä—ã—Ç–æ
                
                const header = document.createElement('div');
                header.className = 'inline-checklist-header';
                
                const title = document.createElement('div');
                title.className = 'inline-checklist-title';
                
                const completedCount = tech.checklist ? tech.checklist.filter(item => item.completed).length : 0;
                const totalCount = tech.checklist ? tech.checklist.length : 0;
                
                title.innerHTML = `
                    <span>üìã –ß–µ–∫-–ª–∏—Å—Ç</span>
                    <span style="font-size: 0.8em; color: #6c757d;">(${completedCount}/${totalCount})</span>
                `;
                
                const toggle = document.createElement('button');
                toggle.className = 'inline-checklist-toggle';
                toggle.innerHTML = isExpanded ? '‚ñº' : '‚ñ∫';
                toggle.onclick = (e) => {
                    e.stopPropagation();
                    this.toggleChecklist(checklistKey);
                };
                
                header.appendChild(title);
                header.appendChild(toggle);
                checklistContainer.appendChild(header);
                
                const content = document.createElement('div');
                content.className = 'inline-checklist-content';
                if (isExpanded) {
                    content.classList.add('expanded');
                }
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                const progress = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
                
                const stats = document.createElement('div');
                stats.className = 'inline-checklist-stats';
                stats.innerHTML = `
                    –ü—Ä–æ–≥—Ä–µ—Å—Å: ${completedCount}/${totalCount} (${progress}%)
                    <div class="progress-bar" style="width: 100%; margin-top: 5px;">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                `;
                content.appendChild(stats);
                
                // –≠–ª–µ–º–µ–Ω—Ç—ã —á–µ–∫-–ª–∏—Å—Ç–∞
                if (tech.checklist && tech.checklist.length > 0) {
                    tech.checklist.forEach((item, itemIndex) => {
                        const itemElement = document.createElement('div');
                        itemElement.className = `inline-checklist-item ${item.completed ? 'completed' : ''}`;
                        itemElement.innerHTML = `
                            <input type="checkbox" ${item.completed ? 'checked' : ''} 
                                   onchange="checklistManager.toggleChecklistItem('${JSON.stringify(path)}', ${index}, ${itemIndex})">
                            <span class="inline-checklist-item-text">${item.text}</span>
                            <button onclick="checklistManager.editChecklistItemInAccordion('${JSON.stringify(path)}', ${index}, ${itemIndex})" style="margin-left: 5px; padding: 2px 6px; font-size: 0.8em;">‚úèÔ∏è</button>
                            <button onclick="checklistManager.removeChecklistItemInAccordion('${JSON.stringify(path)}', ${index}, ${itemIndex})" class="delete" style="margin-left: 2px; padding: 2px 6px; font-size: 0.8em;">üóëÔ∏è</button>
                        `;
                        content.appendChild(itemElement);
                    });
                }
                
                // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                const actions = document.createElement('div');
                actions.className = 'inline-checklist-actions';
                actions.innerHTML = `
                    <button onclick="checklistManager.manageChecklist('${JSON.stringify(path)}', ${index})" class="warning" style="font-size: 0.8em; padding: 4px 8px;">üìã –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
                    <button onclick="checklistManager.addChecklistItemInAccordion('${JSON.stringify(path)}', ${index})" style="font-size: 0.8em; padding: 4px 8px;">+ –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç</button>
                `;
                content.appendChild(actions);
                
                checklistContainer.appendChild(content);
                return checklistContainer;
            },
            
            toggleChecklist(checklistKey) {
                this.checklistExpandedState[checklistKey] = !this.checklistExpandedState[checklistKey];
                this.renderAccordion();
            },
            
            // –†–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è —É–∑–ª–∞ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
            calculateNodeProgress(node) {
                if (node.type === 'technology') {
                    // –î–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                    if (node.checklist && node.checklist.length > 0) {
                        // –ï—Å–ª–∏ –µ—Å—Ç—å —á–µ–∫-–ª–∏—Å—Ç, —Å—á–∏—Ç–∞–µ–º –ø–æ –Ω–µ–º—É
                        const completed = node.checklist.filter(item => item.completed).length;
                        const total = node.checklist.length;
                        const progress = total > 0 ? (completed / total) * 100 : 0;
                        return { progress, hasChecklistItems: true };
                    } else {
                        // –ï—Å–ª–∏ –Ω–µ—Ç —á–µ–∫-–ª–∏—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª–µ completed
                        const progress = node.completed ? 100 : 0;
                        return { progress, hasChecklistItems: false };
                    }
                } else {
                    // –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—Å–µ—Ö –¥–µ—Ç–µ–π
                    if (!node.children || node.children.length === 0) {
                        return { progress: 0, hasChecklistItems: false };
                    }
                    
                    let totalProgress = 0;
                    let childCount = 0;
                    let hasChecklistItems = false;
                    
                    node.children.forEach(child => {
                        const childProgress = this.calculateNodeProgress(child);
                        totalProgress += childProgress.progress;
                        childCount++;
                        if (childProgress.hasChecklistItems) {
                            hasChecklistItems = true;
                        }
                    });
                    
                    const progress = childCount > 0 ? totalProgress / childCount : 0;
                    return { progress, hasChecklistItems };
                }
            }
        };

        // === –ú–ï–ù–ï–î–ñ–ï–† –î–ê–ù–ù–´–• ===
        const dataManager = {
            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—É—Ç—è–º–∏
            getNodeByPath(path) {
                let currentNode = techData.categories;
                for (const index of path) {
                    if (currentNode[index]) {
                        currentNode = currentNode[index].children || [];
                    } else {
                        return null;
                    }
                }
                return currentNode;
            },

            getNodeAtIndex(path, index) {
                const parent = this.getNodeByPath(path);
                return parent ? parent[index] : null;
            },

            // === –õ–û–ö–ê–õ–¨–ù–û–ï –•–†–ê–ù–ò–õ–ò–©–ï ===
            saveToLocalStorage() {
                localStorage.setItem('techData', JSON.stringify(techData));
            },

            loadFromLocalStorage() {
                const saved = localStorage.getItem('techData');
                if (saved) {
                    try {
                        const parsedData = JSON.parse(saved);
                        techData.categories = parsedData.categories || [];
                        this.renderCurrentView();
                    } catch (e) {
                        console.error('Error parsing saved data:', e);
                    }
                }
            },

            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –≤–∏–¥–∞
            renderCurrentView() {
                accordionManager.renderAccordion();
            },

            // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–ú–ò ===
            addCategory() {
                const name = document.getElementById('newCategoryName').value.trim();
                if (name) {
                    techData.categories.push({
                        name: name,
                        type: 'category',
                        children: []
                    });
                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.hideModals();
                    document.getElementById('newCategoryName').value = '';
                    uiManager.showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                    
                    authManager.scheduleAutoSave();
                } else {
                    uiManager.showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏!', 'error');
                }
            },

            addNode() {
                const name = document.getElementById('newNodeName').value.trim();
                
                if (name && currentModalPath.length >= 0) {
                    const parent = this.getNodeByPath(currentModalPath);
                    if (!parent) {
                        uiManager.showNotification('–û—à–∏–±–∫–∞: —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                        return;
                    }

                    parent.push({
                        name: name,
                        type: 'node',
                        children: []
                    });

                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.hideModals();
                    document.getElementById('newNodeName').value = '';
                    uiManager.showNotification('–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                    
                    authManager.scheduleAutoSave();
                } else {
                    uiManager.showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏!', 'error');
                }
            },

            addTechnology() {
                const name = document.getElementById('newTechName').value.trim();
                
                if (name && currentModalPath.length >= 0) {
                    const parent = this.getNodeByPath(currentModalPath);
                    if (!parent) {
                        uiManager.showNotification('–û—à–∏–±–∫–∞: —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                        return;
                    }

                    const tech = {
                        name: name,
                        type: 'technology',
                        checklist: [],
                        completed: false
                    };

                    parent.push(tech);

                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.hideModals();
                    document.getElementById('newTechName').value = '';
                    uiManager.showNotification('–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                    
                    authManager.scheduleAutoSave();
                } else {
                    uiManager.showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏!', 'error');
                }
            },

            // –§—É–Ω–∫—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            editNode(pathStr, index) {
                const path = JSON.parse(pathStr);
                const node = this.getNodeAtIndex(path, index);
                if (!node) return;

                const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:', node.name);
                if (newName && newName.trim()) {
                    node.name = newName.trim();
                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
                    authManager.scheduleAutoSave();
                }
            },

            editTechnology(pathStr, index) {
                const path = JSON.parse(pathStr);
                const node = this.getNodeAtIndex(path, index);
                if (!node) return;

                const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:', node.name);
                if (newName && newName.trim()) {
                    node.name = newName.trim();
                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.showNotification('–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
                    authManager.scheduleAutoSave();
                }
            },

            // –§—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è
            deleteNode(pathStr, index) {
                const path = JSON.parse(pathStr);
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –≤—Å–µ –µ—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ?')) {
                    const parent = this.getNodeByPath(path);
                    if (parent) {
                        parent.splice(index, 1);
                        this.renderCurrentView();
                        this.saveToLocalStorage();
                        uiManager.showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞!', 'success');
                        authManager.scheduleAutoSave();
                    }
                }
            },

            deleteTechnology(pathStr, index) {
                const path = JSON.parse(pathStr);
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é –∏ –≤—Å–µ –µ—ë –∑–∞–¥–∞—á–∏?')) {
                    const parent = this.getNodeByPath(path);
                    if (parent) {
                        parent.splice(index, 1);
                        this.renderCurrentView();
                        this.saveToLocalStorage();
                        uiManager.showNotification('–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è —É–¥–∞–ª–µ–Ω–∞!', 'success');
                        authManager.scheduleAutoSave();
                    }
                }
            },

            // === –†–ê–ë–û–¢–ê –° JSON ===
            exportToJSON() {
                const jsonOutput = document.getElementById('jsonOutput');
                const jsonSection = document.getElementById('jsonSection');
                
                jsonOutput.value = JSON.stringify(techData, null, 2);
                jsonSection.classList.remove('hidden');
            },

            importFromJSON() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const parsedData = JSON.parse(e.target.result);
                            techData.categories = parsedData.categories || [];
                            dataManager.renderCurrentView();
                            dataManager.saveToLocalStorage();
                            uiManager.showNotification('–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
                            authManager.scheduleAutoSave();
                        } catch (error) {
                            uiManager.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ JSON —Ñ–∞–π–ª–∞', 'error');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            },

            importFromJSONText() {
                const jsonText = document.getElementById('jsonOutput').value;
                try {
                    const parsedData = JSON.parse(jsonText);
                    techData.categories = parsedData.categories || [];
                    this.renderCurrentView();
                    this.saveToLocalStorage();
                    uiManager.showNotification('–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ JSON!', 'success');
                    authManager.scheduleAutoSave();
                } catch (error) {
                    uiManager.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–∑–±–æ—Ä–µ JSON', 'error');
                }
            },

            copyToClipboard() {
                const jsonOutput = document.getElementById('jsonOutput');
                jsonOutput.select();
                document.execCommand('copy');
                uiManager.showNotification('JSON —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            }
        };

        // === –ú–ï–ù–ï–î–ñ–ï–† –ò–ù–¢–ï–†–§–ï–ô–°–ê ===
        const uiManager = {
            showModal(modalId) {
                document.getElementById(modalId).style.display = 'block';
            },

            showAddNodeModal(pathStr = '[]') {
                const path = JSON.parse(pathStr);
                currentModalPath = path;
                this.updateParentSelect('nodeModal', path);
                this.showModal('nodeModal');
            },

            showAddTechModal(pathStr = '[]') {
                const path = JSON.parse(pathStr);
                currentModalPath = path;
                this.updateParentSelect('techModal', path);
                this.showModal('techModal');
            },

            hideModals() {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            },

            hideJSON() {
                document.getElementById('jsonSection').classList.add('hidden');
            },

            updateParentSelect(modalId, currentPath) {
                const container = document.getElementById(modalId === 'nodeModal' ? 'nodeParentSelect' : 'techParentSelect');
                if (!container) return;
                
                container.innerHTML = '';
                
                const title = document.createElement('div');
                title.innerHTML = `<strong>–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${this.getPathDisplay(currentPath) || '–ö–æ—Ä–µ–Ω—å'}`;
                container.appendChild(title);
            },

            getPathDisplay(path) {
                if (path.length === 0) return '';
                let currentNode = techData.categories;
                let pathNames = [];
                
                for (const index of path) {
                    if (currentNode[index]) {
                        pathNames.push(currentNode[index].name);
                        currentNode = currentNode[index].children || [];
                    }
                }
                
                return pathNames.join(' ‚Üí ');
            },

            showNotification(message, type) {
                const oldNotifications = document.querySelectorAll('.notification');
                oldNotifications.forEach(notif => notif.remove());
                
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }
        };

        // === –ú–ï–ù–ï–î–ñ–ï–† –ß–ï–ö-–õ–ò–°–¢–û–í ===
        const checklistManager = {
            currentChecklist: {
                path: [],
                techIndex: -1
            },

            // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –ß–ï–ö-–õ–ò–°–¢–ê–ú–ò ===
            manageChecklist(pathStr, techIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = {
                    path,
                    techIndex
                };
                
                const tech = this.getTechnology();
                if (!tech) return;
                
                document.getElementById('checklistTitle').textContent = `–ß–µ–∫-–ª–∏—Å—Ç: ${tech.name}`;
                
                if (!tech.checklist) {
                    tech.checklist = [];
                }
                
                this.renderChecklist();
                uiManager.showModal('checklistModal');
            },
            
            renderChecklist() {
                const tech = this.getTechnology();
                if (!tech) return;
                
                const checklistItems = document.getElementById('checklistItems');
                const checklistStats = document.getElementById('checklistStats');
                
                if (!checklistItems || !checklistStats) return;
                
                checklistItems.innerHTML = '';
                
                if (tech.checklist && tech.checklist.length > 0) {
                    tech.checklist.forEach((item, index) => {
                        const itemElement = document.createElement('div');
                        itemElement.className = `checklist-item ${item.completed ? 'completed' : ''}`;
                        itemElement.innerHTML = `
                            <input type="checkbox" ${item.completed ? 'checked' : ''} 
                                   onchange="checklistManager.toggleChecklistItem('${JSON.stringify(this.currentChecklist.path)}', ${this.currentChecklist.techIndex}, ${index})">
                            <span class="checklist-item-text">${item.text}</span>
                            <button onclick="checklistManager.removeChecklistItem(${index})" class="delete" style="margin-left: 10px;">üóëÔ∏è</button>
                            <button onclick="checklistManager.editChecklistItem(${index})" style="margin-left: 5px;">‚úèÔ∏è</button>
                        `;
                        checklistItems.appendChild(itemElement);
                    });
                } else {
                    checklistItems.innerHTML = '<p style="text-align: center; color: #6c757d;">–ß–µ–∫-–ª–∏—Å—Ç –ø—É—Å—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π –ø—É–Ω–∫—Ç!</p>';
                }
                
                const completed = tech.checklist ? tech.checklist.filter(item => item.completed).length : 0;
                const total = tech.checklist ? tech.checklist.length : 0;
                const progress = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                checklistStats.innerHTML = `
                    –ü—Ä–æ–≥—Ä–µ—Å—Å: ${completed}/${total} (${progress}%)
                    <div class="progress-bar" style="width: 100%; margin-top: 5px;">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                `;
            },
            
            addChecklistItem() {
                const input = document.getElementById('newChecklistItem');
                if (!input) return;
                
                const text = input.value.trim();
                
                if (text) {
                    const tech = this.getTechnology();
                    if (!tech) return;
                    
                    if (!tech.checklist) {
                        tech.checklist = [];
                    }
                    
                    tech.checklist.push({
                        text: text,
                        completed: false
                    });
                    
                    input.value = '';
                    this.renderChecklist();
                    dataManager.saveToLocalStorage();
                    authManager.scheduleAutoSave();
                    dataManager.renderCurrentView();
                }
            },

            addChecklistItemInAccordion(pathStr, techIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = { path, techIndex };
                const text = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç–∞:');
                if (text && text.trim()) {
                    const tech = this.getTechnology();
                    if (!tech) return;
                    
                    if (!tech.checklist) {
                        tech.checklist = [];
                    }
                    
                    tech.checklist.push({
                        text: text.trim(),
                        completed: false
                    });
                    
                    dataManager.saveToLocalStorage();
                    authManager.scheduleAutoSave();
                    dataManager.renderCurrentView();
                }
            },
            
            removeChecklistItem(index) {
                const tech = this.getTechnology();
                if (!tech) return;
                
                if (tech.checklist && tech.checklist.length > index) {
                    tech.checklist.splice(index, 1);
                    this.renderChecklist();
                    dataManager.saveToLocalStorage();
                    authManager.scheduleAutoSave();
                    dataManager.renderCurrentView();
                }
            },

            removeChecklistItemInAccordion(pathStr, techIndex, itemIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = { path, techIndex };
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç–∞?')) {
                    const tech = this.getTechnology();
                    if (!tech) return;
                    
                    if (tech.checklist && tech.checklist.length > itemIndex) {
                        tech.checklist.splice(itemIndex, 1);
                        dataManager.saveToLocalStorage();
                        authManager.scheduleAutoSave();
                        dataManager.renderCurrentView();
                    }
                }
            },
            
            editChecklistItem(index) {
                const tech = this.getTechnology();
                if (!tech) return;
                
                if (tech.checklist && tech.checklist.length > index) {
                    const newText = prompt('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É–Ω–∫—Ç:', tech.checklist[index].text);
                    if (newText !== null) {
                        tech.checklist[index].text = newText.trim();
                        this.renderChecklist();
                        dataManager.saveToLocalStorage();
                        authManager.scheduleAutoSave();
                        dataManager.renderCurrentView();
                    }
                }
            },

            editChecklistItemInAccordion(pathStr, techIndex, itemIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = { path, techIndex };
                const tech = this.getTechnology();
                if (!tech) return;
                
                if (tech.checklist && tech.checklist.length > itemIndex) {
                    const newText = prompt('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É–Ω–∫—Ç:', tech.checklist[itemIndex].text);
                    if (newText !== null) {
                        tech.checklist[itemIndex].text = newText.trim();
                        dataManager.saveToLocalStorage();
                        authManager.scheduleAutoSave();
                        dataManager.renderCurrentView();
                    }
                }
            },
            
            toggleChecklistItem(pathStr, techIndex, itemIndex) {
                const path = JSON.parse(pathStr);
                this.currentChecklist = { path, techIndex };
                const tech = this.getTechnology();
                if (!tech) return;
                
                if (tech.checklist && tech.checklist.length > itemIndex) {
                    tech.checklist[itemIndex].completed = !tech.checklist[itemIndex].completed;
                    dataManager.saveToLocalStorage();
                    authManager.scheduleAutoSave();
                    dataManager.renderCurrentView();
                }
            },
            
            saveChecklist() {
                uiManager.hideModals();
                dataManager.saveToLocalStorage();
                uiManager.showNotification('–ß–µ–∫-–ª–∏—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
                authManager.scheduleAutoSave();
                dataManager.renderCurrentView();
            },
            
            getTechnology() {
                const parent = dataManager.getNodeByPath(this.currentChecklist.path);
                return parent ? parent[this.currentChecklist.techIndex] : null;
            }
        };

        // === –ú–ï–ù–ï–î–ñ–ï–† –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò –ò –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò ===
        const authManager = {
            autoSaveEnabled: false,
            autoSaveInterval: null,
            lastSaveTime: null,
            autoSaveTimeout: null,

            // === –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø –° –ü–†–û–í–ï–†–ö–û–ô ===
            async testAuth() {
                const token = document.getElementById('githubToken').value;
                const owner = document.getElementById('repoOwner').value;
                const repo = document.getElementById('repoName').value;
                
                if (!token || !owner || !repo) {
                    this.showAuthStatus('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
                    return;
                }

                try {
                    this.showAuthStatus('–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...', 'warning');
                    
                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}`, {
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'TechDocs-App'
                        }
                    });

                    const responseData = await response.json();

                    if (response.status === 200) {
                        const permissions = responseData.permissions;
                        if (permissions && permissions.push) {
                            this.showAuthStatus('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ! –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏.', 'success');
                            this.enableAutoSave();
                        } else {
                            this.showAuthStatus('‚ö†Ô∏è –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å.', 'warning');
                        }
                    } else if (response.status === 404) {
                        this.showAuthStatus('‚ùå –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è –∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞.', 'error');
                    } else if (response.status === 401) {
                        this.showAuthStatus('‚ùå –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω.', 'error');
                    } else if (response.status === 403) {
                        this.showAuthStatus('üö´ –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ repo.', 'error');
                    } else {
                        this.showAuthStatus(`‚ùå –û—à–∏–±–∫–∞: ${response.status} - ${responseData.message || response.statusText}`, 'error');
                    }
                } catch (error) {
                    console.error('Auth test error:', error);
                    this.showAuthStatus('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message, 'error');
                }
            },

            saveAuth() {
                const token = document.getElementById('githubToken').value;
                const owner = document.getElementById('repoOwner').value;
                const repo = document.getElementById('repoName').value;
                
                if (token && owner && repo) {
                    localStorage.setItem('githubToken', token);
                    localStorage.setItem('repoOwner', owner);
                    localStorage.setItem('repoName', repo);
                    uiManager.showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
                    setTimeout(() => this.testAuth(), 500);
                } else {
                    uiManager.showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
                }
            },

            loadAuth() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (token) document.getElementById('githubToken').value = token;
                if (owner) document.getElementById('repoOwner').value = owner;
                if (repo) document.getElementById('repoName').value = repo;
                
                if (token && owner && repo) {
                    setTimeout(() => this.testAuth(), 1000);
                }
            },

            showAuthStatus(message, type) {
                const authStatus = document.getElementById('authStatus');
                if (!authStatus) return;
                
                authStatus.textContent = message;
                authStatus.className = 'auth-status';
                authStatus.classList.add(type === 'success' ? 'auth-success' : 
                                       type === 'warning' ? 'auth-warning' : 'auth-error');
                authStatus.style.display = 'block';
            },

            // === –ê–í–¢–û–°–û–•–†–ê–ù–ï–ù–ò–ï –° –ü–†–ï–î–û–¢–í–†–ê–©–ï–ù–ò–ï–ú –ü–ï–†–ï–ó–ê–ü–ò–°–ò ===
            enableAutoSave() {
                if (this.autoSaveEnabled) return;
                
                this.autoSaveEnabled = true;
                this.updateAutoSaveButton();
                
                this.autoSaveInterval = setInterval(() => {
                    this.autoSaveToGitHub();
                }, 2 * 60 * 1000);
                
                window.addEventListener('beforeunload', this.autoSaveToGitHub.bind(this));
                
                uiManager.showNotification('üîÑ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ (–∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã)', 'success');
            },
            
            disableAutoSave() {
                if (this.autoSaveInterval) {
                    clearInterval(this.autoSaveInterval);
                    this.autoSaveInterval = null;
                }
                this.autoSaveEnabled = false;
                this.updateAutoSaveButton();
                window.removeEventListener('beforeunload', this.autoSaveToGitHub.bind(this));
                uiManager.showNotification('‚è∏Ô∏è –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ', 'warning');
            },
            
            toggleAutoSave() {
                if (this.autoSaveEnabled) {
                    this.disableAutoSave();
                } else {
                    this.enableAutoSave();
                }
            },
            
            updateAutoSaveButton() {
                const button = document.getElementById('autoSaveBtn');
                if (!button) return;
                
                if (this.autoSaveEnabled) {
                    button.innerHTML = '‚úÖ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ';
                    button.className = 'auto-save-enabled';
                } else {
                    button.innerHTML = 'üö´ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ';
                    button.className = 'auto-save-disabled';
                }
            },
            
            async autoSaveToGitHub() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (!token || !owner || !repo || !this.autoSaveEnabled) {
                    return;
                }

                const now = Date.now();
                if (this.lastSaveTime && (now - this.lastSaveTime) < 30000) {
                    return;
                }

                try {
                    console.log('üîÑ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ GitHub...');
                    
                    let currentRemoteSha = null;
                    let remoteData = null;
                    
                    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞ GitHub
                    try {
                        const getResponse = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                            headers: {
                                'Authorization': `token ${token}`,
                                'Accept': 'application/vnd.github.v3+json',
                                'User-Agent': 'TechDocs-App'
                            }
                        });
                        
                        if (getResponse.status === 200) {
                            const data = await getResponse.json();
                            currentRemoteSha = data.sha;
                            
                            // –ï—Å–ª–∏ —Ñ–∞–π–ª –∏–∑–º–µ–Ω–∏–ª—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                            if (lastKnownRemoteSha && currentRemoteSha !== lastKnownRemoteSha) {
                                console.log('‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–ª—è —Å–ª–∏—è–Ω–∏—è...');
                                const remoteContent = decodeURIComponent(escape(atob(data.content)));
                                remoteData = JSON.parse(remoteContent);
                                
                                // –°–ª–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                                this.mergeData(remoteData);
                            }
                            
                            lastKnownRemoteSha = currentRemoteSha;
                        } else if (getResponse.status === 404) {
                            // –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                            console.log('üìù –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π');
                        }
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ–∞–π–ª–∞ –¥–ª—è –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
                        return;
                    }

                    const content = JSON.stringify(techData, null, 2);
                    const contentBase64 = btoa(unescape(encodeURIComponent(content)));
                    const message = `Auto-save: ${new Date().toLocaleString()}`;
                    
                    const requestBody = {
                        message: message,
                        content: contentBase64
                    };

                    if (currentRemoteSha) {
                        requestBody.sha = currentRemoteSha;
                    }

                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json',
                            'User-Agent': 'TechDocs-App'
                        },
                        body: JSON.stringify(requestBody)
                    });

                    if (response.status === 200 || response.status === 201) {
                        this.lastSaveTime = Date.now();
                        lastSyncTime = Date.now();
                        this.updateSyncStatus();
                        console.log('‚úÖ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ');
                        
                        if (!document.hidden) {
                            this.showAutoSaveNotification();
                        }
                    } else {
                        console.warn('‚ö†Ô∏è –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å:', response.status);
                        
                        // –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–∞–∑—Ä–µ—à–∏—Ç—å –µ–≥–æ
                        if (response.status === 409) {
                            this.handleSyncConflict();
                        }
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                }
            },
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–ª–∏—è–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
            mergeData(remoteData) {
                if (!remoteData || !remoteData.categories) return;
                
                console.log('üîÑ –ù–∞—á–∏–Ω–∞–µ–º —Å–ª–∏—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...');
                
                // –ü—Ä–æ—Å—Ç–æ–µ —Å–ª–∏—è–Ω–∏–µ: –¥–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞
                remoteData.categories.forEach(remoteCategory => {
                    const localCategory = techData.categories.find(cat => cat.name === remoteCategory.name);
                    
                    if (!localCategory) {
                        // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –¥–æ–±–∞–≤–ª—è–µ–º –µ—ë
                        techData.categories.push(JSON.parse(JSON.stringify(remoteCategory)));
                        console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è: ${remoteCategory.name}`);
                    } else {
                        // –°–ª–∏–≤–∞–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                        this.mergeTechnologies(localCategory, remoteCategory);
                    }
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                dataManager.saveToLocalStorage();
                dataManager.renderCurrentView();
                
                uiManager.showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'success');
            },

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–ª–∏—è–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
            mergeTechnologies(localCategory, remoteCategory) {
                if (!remoteCategory.children) return;
                
                remoteCategory.children.forEach(remoteItem => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è/–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è
                    const exists = localCategory.children.some(localItem => 
                        localItem.name === remoteItem.name && localItem.type === remoteItem.type
                    );
                    
                    if (!exists) {
                        // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
                        localCategory.children.push(JSON.parse(JSON.stringify(remoteItem)));
                        console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω ${remoteItem.type === 'technology' ? '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è' : '–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è'}: ${remoteItem.name}`);
                    } else if (remoteItem.type === 'technology') {
                        // –î–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ —Å–ª–∏–≤–∞—Ç—å —á–µ–∫-–ª–∏—Å—Ç—ã
                        this.mergeChecklists(localCategory, remoteItem);
                    }
                });
            },

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–ª–∏—è–Ω–∏—è —á–µ–∫-–ª–∏—Å—Ç–æ–≤
            mergeChecklists(localCategory, remoteTech) {
                const localTech = localCategory.children.find(item => 
                    item.name === remoteTech.name && item.type === 'technology'
                );
                
                if (!localTech || !remoteTech.checklist) return;
                
                if (!localTech.checklist) {
                    localTech.checklist = [];
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—É–Ω–∫—Ç—ã —á–µ–∫-–ª–∏—Å—Ç–∞
                remoteTech.checklist.forEach(remoteItem => {
                    const exists = localTech.checklist.some(localItem => 
                        localItem.text === remoteItem.text
                    );
                    
                    if (!exists) {
                        localTech.checklist.push(JSON.parse(JSON.stringify(remoteItem)));
                        console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç–∞: ${remoteItem.text}`);
                    }
                });
            },

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            handleSyncConflict() {
                if (confirm('–û–±–Ω–∞—Ä—É–∂–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π. –•–æ—Ç–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å –≤–∞—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏?')) {
                    this.loadFromGitHubWithMerge();
                } else {
                    uiManager.showNotification('‚ö†Ô∏è –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ –∏–∑-–∑–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞', 'warning');
                    this.disableAutoSave();
                }
            },

            // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å GitHub –¥–ª—è —Å–ª–∏—è–Ω–∏—è
            async loadFromGitHubWithMerge() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (!token || !owner || !repo) {
                    uiManager.showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ GitHub!', 'error');
                    return;
                }

                try {
                    uiManager.showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–ª–∏—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å GitHub...', 'warning');
                    
                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'TechDocs-App'
                        }
                    });

                    if (response.status === 200) {
                        const data = await response.json();
                        const content = decodeURIComponent(escape(atob(data.content)));
                        const remoteData = JSON.parse(content);
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ —Å–ª–∏—è–Ω–∏–µ–º
                        const localDataBackup = JSON.parse(JSON.stringify(techData));
                        
                        // –°–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                        this.mergeData(remoteData);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º SHA
                        lastKnownRemoteSha = data.sha;
                        lastSyncTime = Date.now();
                        this.updateSyncStatus();
                        
                        uiManager.showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã!', 'success');
                        
                        // –í–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ
                        this.enableAutoSave();
                    } else {
                        throw new Error(`GitHub API error: ${response.status}`);
                    }
                } catch (error) {
                    console.error('GitHub load error:', error);
                    uiManager.showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message, 'error');
                }
            },

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            async forceSync() {
                if (confirm('–≠—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é —Å GitHub –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç —Å –≤–∞—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                    await this.loadFromGitHubWithMerge();
                }
            },

            showAutoSaveNotification() {
                const notification = document.createElement('div');
                notification.innerHTML = 'üíæ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ';
                notification.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    right: 20px;
                    background: #28a745;
                    color: white;
                    padding: 8px 12px;
                    border-radius: 4px;
                    font-size: 12px;
                    z-index: 1002;
                    opacity: 0.9;
                `;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 2000);
            },
            
            scheduleAutoSave() {
                if (!this.autoSaveEnabled) return;
                
                if (this.autoSaveTimeout) {
                    clearTimeout(this.autoSaveTimeout);
                }
                
                this.autoSaveTimeout = setTimeout(() => {
                    this.autoSaveToGitHub();
                }, 10000);
            },

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            updateSyncStatus() {
                const syncStatus = document.getElementById('syncStatus');
                if (!syncStatus) return;
                
                if (lastSyncTime) {
                    const lastSync = new Date(lastSyncTime).toLocaleString();
                    syncStatus.innerHTML = `üîÑ –ü–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: ${lastSync}`;
                } else {
                    syncStatus.innerHTML = '‚è≥ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å';
                }
            },

            // === –†–ê–ë–û–¢–ê –° GITHUB API ===
            async loadFromGitHub() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (!token || !owner || !repo) {
                    uiManager.showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ GitHub!', 'error');
                    return;
                }

                try {
                    uiManager.showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å GitHub...', 'warning');
                    
                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'TechDocs-App'
                        }
                    });

                    if (response.status === 200) {
                        const data = await response.json();
                        const content = decodeURIComponent(escape(atob(data.content)));
                        const parsedData = JSON.parse(content);
                        
                        techData.categories = parsedData.categories || [];
                        dataManager.renderCurrentView();
                        dataManager.saveToLocalStorage();
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                        lastKnownRemoteSha = data.sha;
                        lastSyncTime = Date.now();
                        this.updateSyncStatus();
                        
                        uiManager.showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å GitHub!', 'success');
                    } else if (response.status === 404) {
                        uiManager.showNotification('üìù –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª.', 'warning');
                        techData.categories = [];
                        dataManager.renderCurrentView();
                        dataManager.saveToLocalStorage();
                    } else {
                        const errorData = await response.json();
                        throw new Error(`GitHub API error: ${response.status} - ${errorData.message || response.statusText}`);
                    }
                } catch (error) {
                    console.error('GitHub load error:', error);
                    uiManager.showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message, 'error');
                }
            },

            async saveToGitHub() {
                const token = localStorage.getItem('githubToken');
                const owner = localStorage.getItem('repoOwner');
                const repo = localStorage.getItem('repoName');
                
                if (!token || !owner || !repo) {
                    uiManager.showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ GitHub!', 'error');
                    return;
                }

                try {
                    uiManager.showNotification('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ GitHub...', 'warning');
                    
                    if (!techData || techData.categories.length === 0) {
                        uiManager.showNotification('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!', 'error');
                        return;
                    }

                    let sha = null;
                    
                    try {
                        const getResponse = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                            headers: {
                                'Authorization': `token ${token}`,
                                'Accept': 'application/vnd.github.v3+json',
                                'User-Agent': 'TechDocs-App'
                            }
                        });
                        
                        if (getResponse.status === 200) {
                            const data = await getResponse.json();
                            sha = data.sha;
                        }
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ–∞–π–ª–∞:', e);
                    }

                    const content = JSON.stringify(techData, null, 2);
                    const contentBase64 = btoa(unescape(encodeURIComponent(content)));
                    const message = `Update tech data: ${new Date().toLocaleString()}`;
                    
                    const requestBody = {
                        message: message,
                        content: contentBase64
                    };

                    if (sha) {
                        requestBody.sha = sha;
                    }

                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/tech-data.json`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json',
                            'User-Agent': 'TechDocs-App'
                        },
                        body: JSON.stringify(requestBody)
                    });

                    const responseData = await response.json();

                    if (response.status === 200 || response.status === 201) {
                        lastSyncTime = Date.now();
                        this.updateSyncStatus();
                        uiManager.showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ GitHub!', 'success');
                    } else {
                        let errorMessage = `–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${response.status}`;
                        if (responseData && responseData.message) {
                            errorMessage += ` - ${responseData.message}`;
                            
                            if (responseData.message.includes('bad credentials')) {
                                errorMessage += '\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞';
                            } else if (responseData.message.includes('not found')) {
                                errorMessage += '\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞';
                            } else if (responseData.message.includes('sha')) {
                                errorMessage += '\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞, –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å';
                            }
                        }
                        throw new Error(errorMessage);
                    }
                } catch (error) {
                    console.error('GitHub save error:', error);
                    uiManager.showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + error.message, 'error');
                }
            }
        };

        // === –£–õ–£–ß–®–ï–ù–ù–´–ô –†–ï–î–ê–ö–¢–û–† –ë–ê–ó–´ –ó–ù–ê–ù–ò–ô ===
        const knowledgeEditor = {
            undoStack: [],
            redoStack: [],
            maxHistory: 50,
            
            init() {
                const editor = document.getElementById('knowledgeEditor');
                if (!editor) return;
                
                // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                editor.addEventListener('input', () => {
                    this.saveToHistory();
                    this.updateStats();
                });
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                this.updateStats();
            },
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
            formatText(command, value = null) {
                document.execCommand(command, false, value);
                document.getElementById('knowledgeEditor').focus();
                this.saveToHistory();
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
            insertHeading(level) {
                this.formatText('formatBlock', `<h${level}>`);
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ —Å–ø–∏—Å–∫–∞
            insertList(type) {
                this.formatText(type === 'ul' ? 'insertUnorderedList' : 'insertOrderedList');
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ —Ü–∏—Ç–∞—Ç—ã
            insertBlockquote() {
                this.formatText('formatBlock', '<blockquote>');
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ —Å—Å—ã–ª–∫–∏
            insertLink() {
                const url = prompt('–í–≤–µ–¥–∏—Ç–µ URL:');
                if (url) {
                    this.formatText('createLink', url);
                }
            },
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫
            showInternalLinkModal() {
                knowledgeManager.showInternalLinkModal();
            },
            
            // –í—Å—Ç–∞–≤–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Å—ã–ª–∫—É
            insertInternalLink(item) {
                const linkHtml = `<a href="#" class="internal-link" data-item-id="${item.id}" data-item-type="${item.type}">${item.name}</a>`;
                this.insertHtml(linkHtml);
                uiManager.hideModals();
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ –∫–æ–¥–∞
            insertCode() {
                const code = prompt('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥:');
                if (code) {
                    this.insertHtml(`<pre><code>${code}</code></pre>`);
                }
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
            insertTable() {
                const rows = parseInt(prompt('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫:', '3')) || 3;
                const cols = parseInt(prompt('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤:', '3')) || 3;
                
                let tableHtml = '<table style="width: 100%; border-collapse: collapse; margin: 10px 0;">';
                tableHtml += '<thead><tr>';
                
                for (let j = 0; j < cols; j++) {
                    tableHtml += `<th style="border: 1px solid #ddd; padding: 8px; background: #f8f9fa;">–ó–∞–≥–æ–ª–æ–≤–æ–∫ ${j+1}</th>`;
                }
                tableHtml += '</tr></thead><tbody>';
                
                for (let i = 0; i < rows; i++) {
                    tableHtml += '<tr>';
                    for (let j = 0; j < cols; j++) {
                        tableHtml += `<td style="border: 1px solid #ddd; padding: 8px;">–Ø—á–µ–π–∫–∞ ${i+1}-${j+1}</td>`;
                    }
                    tableHtml += '</tr>';
                }
                
                tableHtml += '</tbody></table>';
                this.insertHtml(tableHtml);
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            insertImage() {
                const url = prompt('–í–≤–µ–¥–∏—Ç–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:');
                if (url) {
                    this.insertHtml(`<img src="${url}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" style="max-width: 100%; border-radius: 5px; margin: 10px 0;">`);
                }
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ –≤–∏–¥–µ–æ
            insertVideo() {
                const url = prompt('–í–≤–µ–¥–∏—Ç–µ URL –≤–∏–¥–µ–æ:');
                if (url) {
                    this.insertHtml(`<div style="margin: 10px 0;"><video controls style="max-width: 100%;"><source src="${url}"></video></div>`);
                }
            },
            
            // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞
            changeFontSize(size) {
                if (size) {
                    this.formatText('fontSize', size);
                }
            },
            
            // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞
            changeFontFamily(font) {
                if (font) {
                    this.formatText('fontName', font);
                }
            },
            
            // –û—Ç–º–µ–Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è
            undo() {
                if (this.undoStack.length > 0) {
                    const state = this.undoStack.pop();
                    this.redoStack.push(document.getElementById('knowledgeEditor').innerHTML);
                    document.getElementById('knowledgeEditor').innerHTML = state;
                    this.updateStats();
                }
            },
            
            // –ü–æ–≤—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è
            redo() {
                if (this.redoStack.length > 0) {
                    const state = this.redoStack.pop();
                    this.undoStack.push(document.getElementById('knowledgeEditor').innerHTML);
                    document.getElementById('knowledgeEditor').innerHTML = state;
                    this.updateStats();
                }
            },
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            clearFormatting() {
                this.formatText('removeFormat');
                this.formatText('unlink');
            },
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
            saveToHistory() {
                const editor = document.getElementById('knowledgeEditor');
                this.undoStack.push(editor.innerHTML);
                
                if (this.undoStack.length > this.maxHistory) {
                    this.undoStack.shift();
                }
                
                this.redoStack = [];
            },
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStats() {
                const editor = document.getElementById('knowledgeEditor');
                const text = editor.innerText || editor.textContent;
                const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
                const charCount = text.length;
                const readTime = Math.ceil(wordCount / 200);
                
                document.getElementById('editorWordCount').textContent = `–°–ª–æ–≤: ${wordCount}`;
                document.getElementById('editorCharCount').textContent = `–°–∏–º–≤–æ–ª–æ–≤: ${charCount}`;
                document.getElementById('editorReadTime').textContent = `–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è: ${readTime} –º–∏–Ω`;
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ HTML
            insertHtml(html) {
                const editor = document.getElementById('knowledgeEditor');
                const selection = window.getSelection();
                
                if (selection.rangeCount) {
                    const range = selection.getRangeAt(0);
                    range.deleteContents();
                    
                    const div = document.createElement('div');
                    div.innerHTML = html;
                    const fragment = document.createDocumentFragment();
                    
                    while (div.firstChild) {
                        fragment.appendChild(div.firstChild);
                    }
                    
                    range.insertNode(fragment);
                } else {
                    editor.innerHTML += html;
                }
                
                editor.focus();
                this.saveToHistory();
                this.updateStats();
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
            insertTemplate(templateType) {
                let html = '';
                
                switch(templateType) {
                    case 'note':
                        html = `<div class="content-block block-note">
                            <strong>üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong>
                            <div contenteditable="true">–í–∞—à–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ –∑–¥–µ—Å—å...</div>
                        </div>`;
                        break;
                        
                    case 'warning':
                        html = `<div class="content-block block-warning">
                            <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:</strong>
                            <div contenteditable="true">–í–∞–∂–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ...</div>
                        </div>`;
                        break;
                        
                    case 'tip':
                        html = `<div class="content-block block-tip">
                            <strong>üí° –°–æ–≤–µ—Ç:</strong>
                            <div contenteditable="true">–ü–æ–ª–µ–∑–Ω—ã–π —Å–æ–≤–µ—Ç...</div>
                        </div>`;
                        break;
                        
                    case 'cheatsheet':
                        html = `<h2>üìã –®–ø–∞—Ä–≥–∞–ª–∫–∞</h2>
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="border: 1px solid #ddd; padding: 8px; background: #f8f9fa;">–ö–æ–º–∞–Ω–¥–∞</th>
                                    <th style="border: 1px solid #ddd; padding: 8px; background: #f8f9fa;">–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                    <th style="border: 1px solid #ddd; padding: 8px; background: #f8f9fa;">–ü—Ä–∏–º–µ—Ä</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true">–∫–æ–º–∞–Ω–¥–∞ 1</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true">–æ–ø–∏—Å–∞–Ω–∏–µ 1</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true">–ø—Ä–∏–º–µ—Ä 1</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true">–∫–æ–º–∞–Ω–¥–∞ 2</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true">–æ–ø–∏—Å–∞–Ω–∏–µ 2</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true">–ø—Ä–∏–º–µ—Ä 2</td>
                                </tr>
                            </tbody>
                        </table>`;
                        break;
                        
                    case 'tutorial':
                        html = `<h2>üìö –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</h2>
                        <div class="content-block block-note">
                            <strong>–¶–µ–ª—å:</strong>
                            <div contenteditable="true">–û–ø–∏—à–∏—Ç–µ —Ü–µ–ª—å —ç—Ç–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞...</div>
                        </div>
                        
                        <h3>–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞</h3>
                        <div contenteditable="true">–û–ø–∏—à–∏—Ç–µ –ø–µ—Ä–≤—ã–π —à–∞–≥...</div>
                        
                        <h3>–®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</h3>
                        <div contenteditable="true">–û–ø–∏—à–∏—Ç–µ –≤—Ç–æ—Ä–æ–π —à–∞–≥...</div>
                        
                        <div class="content-block block-tip">
                            <strong>üí° –°–æ–≤–µ—Ç:</strong>
                            <div contenteditable="true">–ü–æ–ª–µ–∑–Ω—ã–π —Å–æ–≤–µ—Ç –¥–ª—è —ç—Ç–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞...</div>
                        </div>`;
                        break;
                        
                    case 'comparison':
                        html = `<h2>‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π</h2>
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="border: 1px solid #ddd; padding: 8px; background: #f8f9fa;">–ö—Ä–∏—Ç–µ—Ä–∏–π</th>
                                    <th style="border: 1px solid #ddd; padding: 8px; background: #f8f9fa;">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è A</th>
                                    <th style="border: 1px solid #ddd; padding: 8px; background: #f8f9fa;">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è B</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true"></td>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true"></td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true">–°–ª–æ–∂–Ω–æ—Å—Ç—å</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true"></td>
                                    <td style="border: 1px solid #ddd; padding: 8px;" contenteditable="true"></td>
                                </tr>
                            </tbody>
                        </table>`;
                        break;
                        
                    case 'faq':
                        html = `<h2>‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
                        <div class="content-block block-note">
                            <strong>–í–æ–ø—Ä–æ—Å 1:</strong>
                            <div contenteditable="true">–ö–∞–∫–æ–π-—Ç–æ –≤–æ–ø—Ä–æ—Å...</div>
                            <strong>–û—Ç–≤–µ—Ç:</strong>
                            <div contenteditable="true">–û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å...</div>
                        </div>
                        <div class="content-block block-note">
                            <strong>–í–æ–ø—Ä–æ—Å 2:</strong>
                            <div contenteditable="true">–î—Ä—É–≥–æ–π –≤–æ–ø—Ä–æ—Å...</div>
                            <strong>–û—Ç–≤–µ—Ç:</strong>
                            <div contenteditable="true">–û—Ç–≤–µ—Ç –Ω–∞ –¥—Ä—É–≥–æ–π –≤–æ–ø—Ä–æ—Å...</div>
                        </div>`;
                        break;
                        
                    case 'reference':
                        html = `<h2>üìñ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫</h2>
                        <div class="content-block block-tip">
                            <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong>
                            <div contenteditable="true">–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏...</div>
                        </div>
                        
                        <h3>–°–∏–Ω—Ç–∞–∫—Å–∏—Å</h3>
                        <pre contenteditable="true"><code>// –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞</code></pre>
                        
                        <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
                        <ul contenteditable="true">
                            <li>–ü–∞—Ä–∞–º–µ—Ç—Ä 1: –æ–ø–∏—Å–∞–Ω–∏–µ</li>
                            <li>–ü–∞—Ä–∞–º–µ—Ç—Ä 2: –æ–ø–∏—Å–∞–Ω–∏–µ</li>
                        </ul>`;
                        break;
                        
                    case 'workflow':
                        html = `<h2>üîß –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å</h2>
                        <div class="content-block block-note">
                            <strong>–¶–µ–ª—å –ø—Ä–æ—Ü–µ—Å—Å–∞:</strong>
                            <div contenteditable="true">–û–ø–∏—à–∏—Ç–µ —Ü–µ–ª—å —ç—Ç–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞...</div>
                        </div>
                        
                        <h3>–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞</h3>
                        <div contenteditable="true">–û–ø–∏—à–∏—Ç–µ –ø–µ—Ä–≤—ã–π —à–∞–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞...</div>
                        
                        <h3>–®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</h3>
                        <div contenteditable="true">–û–ø–∏—à–∏—Ç–µ –≤—Ç–æ—Ä–æ–π —à–∞–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞...</div>
                        
                        <h3>–®–∞–≥ 3: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ</h3>
                        <div contenteditable="true">–û–ø–∏—à–∏—Ç–µ –∑–∞–≤–µ—Ä—à–∞—é—â–∏–π —à–∞–≥...</div>`;
                        break;
                }
                
                if (html) {
                    this.insertHtml(html);
                }
            }
        };

        // === –ú–ï–ù–ï–î–ñ–ï–† –ë–ê–ó–´ –ó–ù–ê–ù–ò–ô ===
        const knowledgeManager = {
            currentItem: null,
            
            // –û—Ç–∫—Ä—ã—Ç–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞
            openKnowledgeBase(pathStr, index) {
                const path = JSON.parse(pathStr);
                const item = dataManager.getNodeAtIndex(path, index);
                
                if (!item) {
                    uiManager.showNotification('–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    return;
                }
                
                this.currentItem = item;
                currentKnowledgeItem = item;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–ª–µ content, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                if (!item.content) {
                    item.content = '';
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                if (!item.media) {
                    item.media = [];
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Å—ã–ª–∫–∏, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                if (!item.links) {
                    item.links = [];
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º ID, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                if (!item.id) {
                    item.id = 'item_' + Math.random().toString(36).substr(2, 9);
                }
                
                document.getElementById('knowledgeTitle').textContent = `–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π: ${item.name}`;
                document.getElementById('knowledgeEditor').innerHTML = item.content || '';
                knowledgeEditor.updateStats();
                this.renderPreview();
                this.renderMedia();
                this.renderLinks();
                this.renderLinkedItems();
                
                uiManager.showModal('knowledgeModal');
            },
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
            switchTab(tabName) {
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
                document.querySelectorAll('.content-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
                document.getElementById(`${tabName}Tab`).classList.add('active');
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.content-tab').forEach(tab => {
                    if (tab.textContent.includes(this.getTabIcon(tabName))) {
                        tab.classList.add('active');
                    }
                });
                
                // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∏—Å—å –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä, –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–≤—å—é
                if (tabName === 'preview') {
                    this.renderPreview();
                }
            },
            
            getTabIcon(tabName) {
                const icons = {
                    'editor': '‚úèÔ∏è',
                    'preview': 'üëÅÔ∏è',
                    'media': 'üñºÔ∏è',
                    'links': 'üîó',
                    'templates': 'üìã'
                };
                return icons[tabName] || '';
            },
            
            // –†–µ–Ω–¥–µ—Ä –ø—Ä–µ–≤—å—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            renderPreview() {
                const content = document.getElementById('knowledgeEditor').innerHTML;
                document.getElementById('knowledgePreview').innerHTML = content;
                
                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏
                this.processInternalLinks();
            },
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫ –≤ –ø—Ä–µ–≤—å—é
            processInternalLinks() {
                const internalLinks = document.querySelectorAll('.internal-link');
                internalLinks.forEach(link => {
                    link.onclick = (e) => {
                        e.preventDefault();
                        const targetId = link.getAttribute('data-item-id');
                        this.navigateToInternalLink(targetId);
                    };
                });
            },
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å—Å—ã–ª–∫–∞–º
            navigateToInternalLink(targetId) {
                const targetItem = this.findItemById(targetId);
                if (targetItem) {
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                    uiManager.hideModals();
                    
                    // –ò—â–µ–º –ø—É—Ç—å –∫ —Ü–µ–ª–µ–≤–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
                    const pathInfo = this.findPathToItem(targetId);
                    if (pathInfo) {
                        // –û—Ç–∫—Ä—ã–≤–∞–µ–º –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
                        setTimeout(() => {
                            this.openKnowledgeBase(JSON.stringify(pathInfo.path), pathInfo.index);
                        }, 100);
                    }
                } else {
                    uiManager.showNotification('–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                }
            },
            
            // –†–µ–Ω–¥–µ—Ä –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
            renderMedia() {
                const gallery = document.getElementById('mediaGallery');
                gallery.innerHTML = '';
                
                if (!this.currentItem.media || this.currentItem.media.length === 0) {
                    gallery.innerHTML = '<p style="text-align: center; color: #6c757d;">–ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>';
                    return;
                }
                
                this.currentItem.media.forEach((media, index) => {
                    const mediaItem = document.createElement('div');
                    mediaItem.className = 'media-item';
                    
                    if (media.type === 'image') {
                        mediaItem.innerHTML = `
                            <img src="${media.data}" alt="${media.name}">
                            <div class="media-item-actions">
                                <button onclick="knowledgeManager.deleteMedia(${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                                <button onclick="knowledgeManager.insertMediaToEditor('${media.data}', '${media.type}')" title="–í—Å—Ç–∞–≤–∏—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä">üìù</button>
                            </div>
                        `;
                    } else if (media.type === 'video') {
                        mediaItem.innerHTML = `
                            <video controls>
                                <source src="${media.data}" type="${media.mimeType}">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                            </video>
                            <div class="media-item-actions">
                                <button onclick="knowledgeManager.deleteMedia(${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                                <button onclick="knowledgeManager.insertMediaToEditor('${media.data}', '${media.type}')" title="–í—Å—Ç–∞–≤–∏—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä">üìù</button>
                            </div>
                        `;
                    }
                    
                    gallery.appendChild(mediaItem);
                });
            },
            
            // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ —Å—Å—ã–ª–æ–∫
            renderLinks() {
                const linksList = document.getElementById('linksList');
                linksList.innerHTML = '';
                
                // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Å—ã–ª–æ–∫
                const allTech = this.getAllTechnologies();
                
                if (allTech.length === 0) {
                    linksList.innerHTML = '<p style="text-align: center; color: #6c757d;">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                    return;
                }
                
                allTech.forEach(tech => {
                    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
                    if (tech === this.currentItem) return;
                    
                    const isLinked = this.currentItem.links && 
                                    this.currentItem.links.some(link => link.id === tech.id);
                    
                    const linkItem = document.createElement('div');
                    linkItem.className = 'link-item';
                    linkItem.innerHTML = `
                        <span>${tech.type === 'technology' ? '‚öôÔ∏è' : 'üìÅ'} ${tech.name}</span>
                        <button onclick="knowledgeManager.toggleLink('${tech.id}')" 
                                class="${isLinked ? 'success' : ''}">
                            ${isLinked ? '‚úÖ' : 'üîó'}
                        </button>
                    `;
                    
                    linksList.appendChild(linkItem);
                });
            },
            
            // –†–µ–Ω–¥–µ—Ä —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            renderLinkedItems() {
                const linkedItemsList = document.getElementById('linkedItemsList');
                linkedItemsList.innerHTML = '';
                
                if (!this.currentItem.links || this.currentItem.links.length === 0) {
                    linkedItemsList.innerHTML = '<p style="text-align: center; color: #6c757d;">–ù–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤</p>';
                    return;
                }
                
                this.currentItem.links.forEach(link => {
                    const targetItem = this.findItemById(link.id);
                    if (targetItem) {
                        const linkedItem = document.createElement('div');
                        linkedItem.className = 'linked-item';
                        linkedItem.innerHTML = `
                            <span>${targetItem.type === 'technology' ? '‚öôÔ∏è' : 'üìÅ'} ${targetItem.name}</span>
                            <div>
                                <button onclick="knowledgeManager.openLinkedItem('${link.id}')" title="–û—Ç–∫—Ä—ã—Ç—å">üëÅÔ∏è</button>
                                <button onclick="knowledgeManager.removeLink('${link.id}')" class="delete" title="–£–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å">üóëÔ∏è</button>
                            </div>
                        `;
                        linkedItemsList.appendChild(linkedItem);
                    }
                });
            },
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
            getAllTechnologies() {
                const technologies = [];
                
                function traverse(nodes) {
                    nodes.forEach(node => {
                        if (node.type === 'technology' || node.type === 'category' || node.type === 'node') {
                            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                            if (!node.id) {
                                node.id = 'item_' + Math.random().toString(36).substr(2, 9);
                            }
                            technologies.push(node);
                        }
                        
                        if (node.children) {
                            traverse(node.children);
                        }
                    });
                }
                
                traverse(techData.categories);
                return technologies;
            },
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏
            toggleLink(techId) {
                if (!this.currentItem.links) {
                    this.currentItem.links = [];
                }
                
                const existingIndex = this.currentItem.links.findIndex(link => link.id === techId);
                
                if (existingIndex >= 0) {
                    // –£–¥–∞–ª—è–µ–º —Å—Å—ã–ª–∫—É
                    this.currentItem.links.splice(existingIndex, 1);
                } else {
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É
                    const targetTech = this.findItemById(techId);
                    if (targetTech) {
                        this.currentItem.links.push({
                            id: techId,
                            name: targetTech.name,
                            type: targetTech.type
                        });
                    }
                }
                
                this.renderLinks();
                this.renderLinkedItems();
                this.scheduleSave();
            },
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–∏
            removeLink(techId) {
                if (!this.currentItem.links) return;
                
                const existingIndex = this.currentItem.links.findIndex(link => link.id === techId);
                if (existingIndex >= 0) {
                    this.currentItem.links.splice(existingIndex, 1);
                    this.renderLinks();
                    this.renderLinkedItems();
                    this.scheduleSave();
                }
            },
            
            // –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
            openLinkedItem(itemId) {
                const targetItem = this.findItemById(itemId);
                if (targetItem) {
                    uiManager.hideModals();
                    
                    const pathInfo = this.findPathToItem(itemId);
                    if (pathInfo) {
                        setTimeout(() => {
                            this.openKnowledgeBase(JSON.stringify(pathInfo.path), pathInfo.index);
                        }, 100);
                    }
                }
            },
            
            // –ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ ID
            findItemById(id) {
                function findInNodes(nodes) {
                    for (const node of nodes) {
                        if (node.id === id) {
                            return node;
                        }
                        
                        if (node.children) {
                            const found = findInNodes(node.children);
                            if (found) return found;
                        }
                    }
                    return null;
                }
                
                return findInNodes(techData.categories);
            },
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ —ç–ª–µ–º–µ–Ω—Ç—É
            findPathToItem(targetId, nodes = techData.categories, path = []) {
                for (let i = 0; i < nodes.length; i++) {
                    const node = nodes[i];
                    if (node.id === targetId) {
                        return { path, index: i };
                    }
                    
                    if (node.children && node.children.length > 0) {
                        const result = this.findPathToItem(targetId, node.children, [...path, i]);
                        if (result) return result;
                    }
                }
                return null;
            },
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞
            deleteMedia(index) {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –º–µ–¥–∏–∞—Ñ–∞–π–ª?')) {
                    this.currentItem.media.splice(index, 1);
                    this.renderMedia();
                    this.scheduleSave();
                }
            },
            
            // –í—Å—Ç–∞–≤–∫–∞ –º–µ–¥–∏–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
            insertMediaToEditor(data, type) {
                let insertHtml = '';
                
                if (type === 'image') {
                    insertHtml = `<img src="${data}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" style="max-width: 100%;">`;
                } else if (type === 'video') {
                    insertHtml = `<video controls style="max-width: 100%;"><source src="${data}"></video>`;
                }
                
                knowledgeEditor.insertHtml(insertHtml);
                this.switchTab('editor');
            },
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            saveContent() {
                if (!this.currentItem) return;
                
                this.currentItem.content = document.getElementById('knowledgeEditor').innerHTML;
                this.scheduleSave();
                uiManager.showNotification('–ö–æ–Ω—Ç–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
            },
            
            // –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            exportContent() {
                const content = this.currentItem.content;
                const blob = new Blob([content], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${this.currentItem.name}.html`;
                a.click();
                URL.revokeObjectURL(url);
            },
            
            // –ò–º–ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            importContent() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.html,.txt';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        document.getElementById('knowledgeEditor').innerHTML = e.target.result;
                        this.renderPreview();
                        uiManager.showNotification('–ö–æ–Ω—Ç–µ–Ω—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!', 'success');
                    };
                    reader.readAsText(file);
                };
                input.click();
            },
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π
            showHistory() {
                uiManager.showModal('historyModal');
                this.renderHistory();
            },
            
            // –†–µ–Ω–¥–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏
            renderHistory() {
                const historyList = document.getElementById('historyList');
                historyList.innerHTML = '';
                
                // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏
                // –ü–æ–∫–∞–∂–µ–º –∑–∞–≥–ª—É—à–∫—É
                historyList.innerHTML = `
                    <div class="history-item">
                        <div>
                            <strong>–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è</strong>
                            <div style="font-size: 0.8em; color: #6c757d;">–¢–æ–ª—å–∫–æ —á—Ç–æ</div>
                        </div>
                        <button onclick="knowledgeManager.restoreVersion('current')">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                    <div class="history-item">
                        <div>
                            <strong>–í–µ—Ä—Å–∏—è 1</strong>
                            <div style="font-size: 0.8em; color: #6c757d;">2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</div>
                        </div>
                        <button onclick="knowledgeManager.restoreVersion('1')">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                `;
            },
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏
            restoreVersion(version) {
                // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏
                uiManager.showNotification(`–í–µ—Ä—Å–∏—è ${version} –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞`, 'success');
                uiManager.hideModals();
            },
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫
            showInternalLinkModal() {
                uiManager.showModal('internalLinkModal');
                this.loadInternalLinkItems();
            },
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫
            loadInternalLinkItems() {
                const results = document.getElementById('internalLinkResults');
                results.innerHTML = '';
                
                const allItems = this.getAllKnowledgeItems();
                
                if (allItems.length === 0) {
                    results.innerHTML = '<p style="text-align: center; color: #6c757d;">–≠–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                    return;
                }
                
                allItems.forEach(item => {
                    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
                    if (item === this.currentItem) return;
                    
                    const itemElement = document.createElement('div');
                    itemElement.className = 'internal-link-item';
                    itemElement.innerHTML = `
                        <div>
                            <strong>${item.type === 'technology' ? '‚öôÔ∏è' : 'üìÅ'} ${item.name}</strong>
                            <div style="font-size: 0.8em; color: #6c757d;">${this.getTypeDisplay(item.type)}</div>
                        </div>
                    `;
                    
                    itemElement.onclick = () => {
                        knowledgeEditor.insertInternalLink(item);
                    };
                    
                    results.appendChild(itemElement);
                });
            },
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
            getAllKnowledgeItems() {
                return this.getAllTechnologies(); // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç—É –∂–µ —Ñ—É–Ω–∫—Ü–∏—é
            },
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∏–ø–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
            getTypeDisplay(type) {
                const typeNames = {
                    'category': '–ö–∞—Ç–µ–≥–æ—Ä–∏—è',
                    'node': '–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è', 
                    'technology': '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è'
                };
                
                return typeNames[type] || '–≠–ª–µ–º–µ–Ω—Ç';
            },
            
            // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
            showGlobalSearch() {
                uiManager.showModal('searchModal');
                document.getElementById('globalSearch').focus();
            },
            
            // –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
            performSearch() {
                const query = document.getElementById('globalSearch').value.toLowerCase();
                const results = document.getElementById('searchResults');
                results.innerHTML = '';
                
                if (!query) {
                    results.innerHTML = '<p style="text-align: center; color: #6c757d;">–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>';
                    return;
                }
                
                const searchResults = this.searchInKnowledgeBase(query);
                
                if (searchResults.length === 0) {
                    results.innerHTML = '<p style="text-align: center; color: #6c757d;">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
                    return;
                }
                
                searchResults.forEach(result => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'search-result-item';
                    resultItem.style.padding = '10px';
                    resultItem.style.borderBottom = '1px solid #e9ecef';
                    resultItem.style.cursor = 'pointer';
                    
                    resultItem.innerHTML = `
                        <div style="font-weight: bold;">${result.item.type === 'technology' ? '‚öôÔ∏è' : 'üìÅ'} ${result.item.name}</div>
                        <div style="font-size: 0.9em; color: #6c757d;">${result.context}</div>
                    `;
                    
                    resultItem.onclick = () => {
                        this.openKnowledgeBase(JSON.stringify(result.path), result.index);
                        uiManager.hideModals();
                    };
                    
                    results.appendChild(resultItem);
                });
            },
            
            // –ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
            searchInKnowledgeBase(query) {
                const results = [];
                
                function searchInNodes(nodes, path = []) {
                    nodes.forEach((node, index) => {
                        // –ü–æ–∏—Å–∫ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
                        if (node.name.toLowerCase().includes(query)) {
                            results.push({
                                item: node,
                                path: [...path],
                                index: index,
                                context: `–ù–∞–∑–≤–∞–Ω–∏–µ: ${node.name}`
                            });
                        }
                        
                        // –ü–æ–∏—Å–∫ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ
                        if (node.content && node.content.toLowerCase().includes(query)) {
                            const contentPreview = node.content.replace(/<[^>]*>/g, '').substring(0, 100) + '...';
                            results.push({
                                item: node,
                                path: [...path],
                                index: index,
                                context: `–ö–æ–Ω—Ç–µ–Ω—Ç: ${contentPreview}`
                            });
                        }
                        
                        // –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –≤ –¥–µ—Ç—è—Ö
                        if (node.children) {
                            searchInNodes(node.children, [...path, index]);
                        }
                    });
                }
                
                searchInNodes(techData.categories);
                return results;
            },
            
            // –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
            browseMediaLibrary() {
                uiManager.showNotification('–§—É–Ω–∫—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º–µ–¥–∏–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'warning');
            },
            
            downloadAllMedia() {
                uiManager.showNotification('–§—É–Ω–∫—Ü–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –º–µ–¥–∏–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'warning');
            },
            
            // –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            scheduleSave() {
                dataManager.saveToLocalStorage();
                authManager.scheduleAutoSave();
                accordionManager.renderAccordion();
            }
        };

        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ===
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
            knowledgeEditor.init();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –¥–∞–Ω–Ω—ã—Ö
            authManager.loadAuth();
            dataManager.loadFromLocalStorage();
            accordionManager.init();
            authManager.updateSyncStatus();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è drag & drop –¥–ª—è –º–µ–¥–∏–∞
            const dropZone = document.getElementById('mediaDropZone');
            const fileInput = document.getElementById('mediaUpload');
            
            if (dropZone && fileInput) {
                dropZone.addEventListener('click', () => {
                    fileInput.click();
                });
                
                fileInput.addEventListener('change', (e) => {
                    knowledgeManager.handleFiles(e.target.files);
                });
                
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('dragover');
                });
                
                dropZone.addEventListener('dragleave', () => {
                    dropZone.classList.remove('dragover');
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('dragover');
                    knowledgeManager.handleFiles(e.dataTransfer.files);
                });
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
            const globalSearch = document.getElementById('globalSearch');
            if (globalSearch) {
                globalSearch.addEventListener('input', () => {
                    knowledgeManager.performSearch();
                });
            }
            
            const linkSearch = document.getElementById('linkSearch');
            if (linkSearch) {
                linkSearch.addEventListener('input', () => {
                    knowledgeManager.filterLinks();
                });
            }
            
            const internalLinkSearch = document.getElementById('internalLinkSearch');
            if (internalLinkSearch) {
                internalLinkSearch.addEventListener('input', () => {
                    knowledgeManager.filterInternalLinks();
                });
            }
        });

        // –†–∞—Å—à–∏—Ä—è–µ–º knowledgeManager –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
        knowledgeManager.handleFiles = function(files) {
            for (const file of files) {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    const mediaType = file.type.startsWith('image/') ? 'image' : 
                                    file.type.startsWith('video/') ? 'video' : 'other';
                    
                    if (mediaType === 'other') {
                        uiManager.showNotification('–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞', 'error');
                        return;
                    }
                    
                    if (!this.currentItem.media) {
                        this.currentItem.media = [];
                    }
                    
                    this.currentItem.media.push({
                        name: file.name,
                        type: mediaType,
                        data: e.target.result,
                        mimeType: file.type,
                        size: file.size
                    });
                    
                    this.renderMedia();
                    this.scheduleSave();
                    uiManager.showNotification(`–§–∞–π–ª "${file.name}" –∑–∞–≥—Ä—É–∂–µ–Ω`, 'success');
                };
                
                reader.readAsDataURL(file);
            }
        };

        knowledgeManager.filterLinks = function() {
            const query = document.getElementById('linkSearch').value.toLowerCase();
            const linkItems = document.querySelectorAll('.link-item');
            
            linkItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(query) ? 'flex' : 'none';
            });
        };

        knowledgeManager.filterInternalLinks = function() {
            const query = document.getElementById('internalLinkSearch').value.toLowerCase();
            const linkItems = document.querySelectorAll('.internal-link-item');
            
            linkItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(query) ? 'block' : 'none';
            });
        };

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                uiManager.hideModals();
            }
        };
    </script>
</body>
</html>
