<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technologies Documentation</title>
    <!-- –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ -->
    <style>
        /* –í—Å–µ —Å—Ç–∏–ª–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–¥–∞ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        body {
            font-family: Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        /* ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ ... */
    </style>
</head>
<body>
    <div class="container">
        <h1>üìÅ Technologies Documentation</h1>
        
        <!-- –°–µ–∫—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
        <div class="auth-section" id="authSection">
            <h3>üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ GitHub</h3>
            <div>
                <input type="password" id="githubToken" placeholder="GitHub Personal Access Token" style="width: 300px;">
                <input type="text" id="repoOwner" placeholder="–í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è" style="width: 150px;">
                <input type="text" id="repoName" placeholder="–ò–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è" style="width: 150px;">
                <button onclick="authManager.saveAuth()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <button onclick="authManager.testAuth()" class="success">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
            </div>
            <div id="authStatus" class="auth-status"></div>
            <p><small>–¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ. –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ GitHub —Å –ø—Ä–∞–≤–∞–º–∏ repo</small></p>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã -->
        <div class="controls">
            <div>
                <button onclick="uiManager.showModal('categoryModal')">+ –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                <button onclick="uiManager.showAddNodeModal()">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                <button onclick="uiManager.showAddTechModal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é</button>
                <button onclick="authManager.loadFromGitHub()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å GitHub</button>
                <button onclick="authManager.saveToGitHub()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ GitHub</button>
                <button onclick="authManager.toggleAutoSave()" id="autoSaveBtn">üö´ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</button>
                <button onclick="dataManager.exportToJSON()">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON</button>
                <button onclick="dataManager.importFromJSON()">üì§ –ò–º–ø–æ—Ä—Ç –∏–∑ JSON</button>
                <button onclick="dataManager.loadTechData()" class="success">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å tech-data.json</button>
            </div>
        </div>

        <!-- –û—Å—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å HTML –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
        <!-- ... -->
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
        const techData = {
            categories: []
        };

        let currentModalPath = [];

        // –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const accordionManager = {
            // ... –≤–µ—Å—å –∫–æ–¥ accordionManager –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –∑–∞–≥—Ä—É–∑–∫–æ–π tech-data.json
        document.addEventListener('DOMContentLoaded', function() {
            authManager.loadAuth();
            
            // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage
            const savedData = localStorage.getItem('techData');
            if (savedData) {
                try {
                    const parsedData = JSON.parse(savedData);
                    if (parsedData.categories && parsedData.categories.length > 0) {
                        techData.categories = parsedData.categories;
                        accordionManager.init();
                        console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage');
                        return;
                    }
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage:', e);
                }
            }
            
            // –ï—Å–ª–∏ –≤ localStorage –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ tech-data.json
            dataManager.loadTechData(true);
            
            // –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GitHub
            const token = localStorage.getItem('githubToken');
            const owner = localStorage.getItem('repoOwner');
            const repo = localStorage.getItem('repoName');
            
            if (token && owner && repo) {
                console.log('GitHub –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ');
            }
        });

        const dataManager = {
            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—É—Ç—è–º–∏ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
            getNodeByPath(path) {
                let currentNode = techData.categories;
                for (const index of path) {
                    if (currentNode[index]) {
                        currentNode = currentNode[index].children || [];
                    } else {
                        return null;
                    }
                }
                return currentNode;
            },

            getNodeAtIndex(path, index) {
                const parent = this.getNodeByPath(path);
                return parent ? parent[index] : null;
            },

            // === –ó–ê–ì–†–£–ó–ö–ê –ò–ó TECH-DATA.JSON ===
            loadTechData(autoLoad = false) {
                if (!autoLoad && techData.categories.length > 0) {
                    if (!confirm('–¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ tech-data.json?')) {
                        return;
                    }
                }

                fetch('tech-data.json')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(externalData => {
                        techData.categories = externalData.categories || [];
                        this.renderCurrentView();
                        this.saveToLocalStorage();
                        uiManager.showNotification('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ tech-data.json!', 'success');
                        
                        if (autoLoad) {
                            console.log('–î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ tech-data.json');
                        }
                    })
                    .catch(error => {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ tech-data.json:', error);
                        if (!autoLoad) {
                            uiManager.showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ tech-data.json: ' + error.message, 'error');
                        } else {
                            console.log('–§–∞–π–ª tech-data.json –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –ø—É—Å—Ç—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏');
                            accordionManager.init();
                        }
                    });
            },

            // === –õ–û–ö–ê–õ–¨–ù–û–ï –•–†–ê–ù–ò–õ–ò–©–ï ===
            saveToLocalStorage() {
                localStorage.setItem('techData', JSON.stringify(techData));
            },

            loadFromLocalStorage() {
                const saved = localStorage.getItem('techData');
                if (saved) {
                    try {
                        const parsedData = JSON.parse(saved);
                        techData.categories = parsedData.categories || [];
                        this.renderCurrentView();
                    } catch (e) {
                        console.error('Error parsing saved data:', e);
                    }
                }
            },

            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –≤–∏–¥–∞
            renderCurrentView() {
                accordionManager.renderAccordion();
            },

            // === –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–ú–ò (–≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ===
            addCategory() {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            addNode() {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            addTechnology() {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            editNode(pathStr, index) {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            editTechnology(pathStr, index) {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            deleteNode(pathStr, index) {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            deleteTechnology(pathStr, index) {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            // === –†–ê–ë–û–¢–ê –° JSON (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ===
            exportToJSON() {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            importFromJSON() {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            importFromJSONText() {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            },

            copyToClipboard() {
                // ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
            }
        };

        // UI Manager (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const uiManager = {
            // ... –≤–µ—Å—å –∫–æ–¥ uiManager –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
        };

        // Checklist Manager (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const checklistManager = {
            // ... –≤–µ—Å—å –∫–æ–¥ checklistManager –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
        };

        // Auth Manager (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const authManager = {
            // ... –≤–µ—Å—å –∫–æ–¥ authManager –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
        };

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                uiManager.hideModals();
            }
        };
    </script>
</body>
</html>
